
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module FUN</title>
<meta name="description" content="Documentation of Coq module FUN" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module FUN</h1>
<div class="coq">
<span class="id">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html">Bool</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Equality.html">Program.Equality</a></span>.<br/>
<span class="id">From</span> <span class="id">CDF</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CDF.Sequences.html">Sequences</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">string_scope</span>.<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<br/>
<h1> 7.  Le langage fonctionnel typé FUN </h1>
<br/>
<h2> 7.1.  Syntaxe et sémantique </h2>
<br/>
<div class="doc">Le langage se compose du lambda-calcul (variables, abstractions de
    fonctions, applications de fonctions) étendu avec les booléens:
    constantes <span class="bracket"><span class="id">Const</span> <span class="id">true</span></span> et <span class="bracket"><span class="id">Const</span> <span class="id">false</span></span>, et conditionnelle
    <span class="bracket"><span class="id">Cond</span> <span class="id">a</span> <span class="id">ifso</span> <span class="id">ifnot</span></span> (c.à.d. <span class="bracket"><span class="kwd">if</span> <span class="id">a</span> <span class="kwd">then</span> <span class="id">ifso</span> <span class="kwd">else</span> <span class="id">ifnot</span></span>).  </div>
&nbsp;<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="term">term</a></span>: <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Var">Var</a></span> (<span class="id">x</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="Abs">Abs</a></span> (<span class="id">x</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) (<span class="id">a</span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="App">App</a></span> (<span class="id">a1</span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span>) (<span class="id">a2</span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="Const">Const</a></span> (<span class="id">b</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="Cond">Cond</a></span> (<span class="id">a</span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span>) (<span class="id">ifso</span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span>) (<span class="id">ifnot</span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span>).<br/>
<br/>
<div class="doc">Les valeurs sont les abstractions de fonctions et les constantes
    booléennes. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="isvalue">isvalue</a></span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="V_Abs">V_Abs</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> (<span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="V_Const">V_Const</a></span>: <span class="kwd">forall</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> (<span class="id"><a href="CDF.FUN.html#Const">Const</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span>).<br/>
<br/>
<div class="doc"><span class="bracket"><span class="tactic">subst</span> <span class="id">a</span> <span class="id">x</span> <span class="id">c</span></span> est la substitution de la variable <span class="bracket"><span class="id">x</span></span> par le terme <span class="bracket"><span class="id">c</span></span>
    dans le terme <span class="bracket"><span class="id">a</span></span>, aussi notée <span class="bracket"><span class="id">a</span> [<span class="id">x</span> ← <span class="id">c</span>]</span> dans le cours. </div>
<br/>
<div class="doc">Cette substitution est incorrecte en général, car elle peut
    capturer des variables qui sont libres dans <span class="bracket"><span class="id">c</span></span>.  On ne peut
    l'utiliser que si <span class="bracket"><span class="id">c</span></span> est un terme clos, sans variables libres, ce
    qui correspond à la réduction de programmes complets, sans
    variables libres.  Le système de types de la section 7.2 assurera
    que c'est bien le cas. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="tactic">subst</span> (<span class="id">a</span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span>) (<span class="id">x</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) (<span class="id">c</span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span>) : <span class="id"><a href="CDF.FUN.html#term">term</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Var">Var</a></span> <span class="id">y</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id">y</span> <span class="kwd">then</span> <span class="id"><a href="CDF.FUN.html#c">c</a></span> <span class="kwd">else</span> <span class="id"><a href="CDF.FUN.html#Var">Var</a></span> <span class="id">y</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id">y</span> <span class="id">a</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id">y</span> <span class="kwd">then</span> <span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id">y</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="kwd">else</span> <span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id">y</span> (<span class="tactic">subst</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#c">c</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#App">App</a></span> <span class="id">a1</span> <span class="id">a2</span> =&gt; <span class="id"><a href="CDF.FUN.html#App">App</a></span> (<span class="tactic">subst</span> <span class="id">a1</span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#c">c</a></span>) (<span class="tactic">subst</span> <span class="id">a2</span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#c">c</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Const">Const</a></span> <span class="id">b</span> =&gt; <span class="id"><a href="CDF.FUN.html#Const">Const</a></span> <span class="id">b</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Cond">Cond</a></span> <span class="id">a</span> <span class="id">ifso</span> <span class="id">ifnot</span> =&gt; <span class="id"><a href="CDF.FUN.html#Cond">Cond</a></span> (<span class="tactic">subst</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#c">c</a></span>) (<span class="tactic">subst</span> <span class="id">ifso</span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#c">c</a></span>) (<span class="tactic">subst</span> <span class="id">ifnot</span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#c">c</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">La sémantique à réductions: <span class="bracket"><span class="tactic">red</span> <span class="id">a</span> <span class="id">a</span>'</span> signifie que <span class="bracket"><span class="id">a</span></span> se réduit
    en une étape vers <span class="bracket"><span class="id">a</span>'</span>.  On choisit une sémantique en appel par
    valeur, avec évaluation des applications de gauche à droite. </div>
<br/>
<span class="kwd">Inductive</span> <span class="tactic">red</span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#term">term</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="red_beta">red_beta</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">a</span> <span class="id">v</span>,        <span class="docright">(* beta réduction en appel par valeur  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> (<span class="id"><a href="CDF.FUN.html#App">App</a></span> (<span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>) <span class="id"><a href="CDF.FUN.html#v">v</a></span>) (<span class="tactic">subst</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="red_cond">red_cond</a></span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ifso</span> <span class="id">ifnot</span>,     <span class="docright">(* réduction de la conditionnelle  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> (<span class="id"><a href="CDF.FUN.html#Cond">Cond</a></span> (<span class="id"><a href="CDF.FUN.html#Const">Const</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span>) <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span>) (<span class="kwd">if</span> <span class="id"><a href="CDF.FUN.html#b">b</a></span> <span class="kwd">then</span> <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="kwd">else</span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="red_app_1">red_app_1</a></span>: <span class="kwd">forall</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">a1</span>', <span class="docright">(* réduction à gauche d'une application  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> <span class="id">a1</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> (<span class="id"><a href="CDF.FUN.html#App">App</a></span> <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span>) (<span class="id"><a href="CDF.FUN.html#App">App</a></span> <span class="id">a1</span>' <span class="id"><a href="CDF.FUN.html#a2">a2</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="red_app_2">red_app_2</a></span>: <span class="kwd">forall</span> <span class="id">v</span> <span class="id">a2</span> <span class="id">a2</span>',  <span class="docright">(* réduction à droite d'une application  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt; <span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span> <span class="id">a2</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> (<span class="id"><a href="CDF.FUN.html#App">App</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span>) (<span class="id"><a href="CDF.FUN.html#App">App</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> <span class="id">a2</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a name="red_cond_1">red_cond_1</a></span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a</span>' <span class="id">ifso</span> <span class="id">ifnot</span>,      <span class="docright">(* réduction sous un <span class="bracket"><span class="id">Cond</span></span>  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id">a</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> (<span class="id"><a href="CDF.FUN.html#Cond">Cond</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span>) (<span class="id"><a href="CDF.FUN.html#Cond">Cond</a></span> <span class="id">a</span>' <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span>).<br/>
<br/>
<h3> Exercice (1 étoile). </h3>
<div class="doc">Modifier <span class="bracket"><span class="tactic">red</span></span> pour obtenir une sémantique en appel par nom.
    Quel est l'impact de ce changement sur les résultats qui suivent? </div>
<br/>
<h3> Exercice (2 étoiles). </h3>
<div class="doc">Enrichir la syntaxe et la sémantique de FUN pour y ajouter une ou
    plusieurs des extensions vues en cours: entiers de Peano,
    produits, sommes, points fixes. </div>
<br/>
<div class="doc">Une autre présentation de la sémantique à réductions, dans le
    style popularisé par Wright et Felleisen.  On définit d'abord les
    réductions en tête de terme. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="head_red">head_red</a></span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#term">term</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="head_red_beta">head_red_beta</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">a</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#head_red">head_red</a></span> (<span class="id"><a href="CDF.FUN.html#App">App</a></span> (<span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>) <span class="id"><a href="CDF.FUN.html#v">v</a></span>) (<span class="tactic">subst</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="head_red_cond">head_red_cond</a></span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ifso</span> <span class="id">ifnot</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#head_red">head_red</a></span> (<span class="id"><a href="CDF.FUN.html#Cond">Cond</a></span> (<span class="id"><a href="CDF.FUN.html#Const">Const</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span>) <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span>) (<span class="kwd">if</span> <span class="id"><a href="CDF.FUN.html#b">b</a></span> <span class="kwd">then</span> <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="kwd">else</span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span>).<br/>
<br/>
<div class="doc">On se donne ensuite un ensemble de contextes de réduction.  Les
    contextes sont représentés par des fonctions <span class="bracket"><span class="id">C</span>: <span class="id">term</span> -&gt; <span class="id">term</span></span>, et
    le prédicat inductif <span class="bracket"><span class="id">iscontext</span> <span class="id">C</span></span> définit lesquelles de ces
    fonctions sont des contextes de réduction bien formés. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="iscontext">iscontext</a></span>: (<span class="id"><a href="CDF.FUN.html#term">term</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#term">term</a></span>) -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="iscontext_hole">iscontext_hole</a></span>:                      <span class="docright">(* au sommet  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#iscontext">iscontext</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="CDF.FUN.html#a">a</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="iscontext_app_1">iscontext_app_1</a></span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">C</span>,         <span class="docright">(* à gauche d'une application  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#iscontext">iscontext</a></span> <span class="id"><a href="CDF.FUN.html#C">C</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#iscontext">iscontext</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="CDF.FUN.html#App">App</a></span> (<span class="id"><a href="CDF.FUN.html#C">C</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span>) <span class="id"><a href="CDF.FUN.html#a">a</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="iscontext_app_2">iscontext_app_2</a></span>: <span class="kwd">forall</span> <span class="id">v</span> <span class="id">C</span>,         <span class="docright">(* à droite d'une application  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#iscontext">iscontext</a></span> <span class="id"><a href="CDF.FUN.html#C">C</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#iscontext">iscontext</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="CDF.FUN.html#App">App</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> (<span class="id"><a href="CDF.FUN.html#C">C</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span>))<br/>
&nbsp;&nbsp;| <span class="id"><a name="iscontext_cond">iscontext_cond</a></span>: <span class="kwd">forall</span> <span class="id">C</span> <span class="id">ifso</span> <span class="id">ifnot</span>, <span class="docright">(* sous une conditionnelle  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#iscontext">iscontext</a></span> <span class="id"><a href="CDF.FUN.html#C">C</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#iscontext">iscontext</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="CDF.FUN.html#Cond">Cond</a></span> (<span class="id"><a href="CDF.FUN.html#C">C</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span>) <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span>).<br/>
<br/>
<div class="doc">La relation de réduction sous contexte. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="ctx_red">ctx_red</a></span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#term">term</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="ctx_red_intro">ctx_red_intro</a></span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a</span>' <span class="id">C</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#head_red">head_red</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id">a</span>' -&gt; <span class="id"><a href="CDF.FUN.html#iscontext">iscontext</a></span> <span class="id"><a href="CDF.FUN.html#C">C</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#ctx_red">ctx_red</a></span> (<span class="id"><a href="CDF.FUN.html#C">C</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>) (<span class="id"><a href="CDF.FUN.html#C">C</a></span> <span class="id">a</span>').<br/>
<br/>
<div class="doc">Equivalence avec la réduction précédente. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ctx_red_to_red">ctx_red_to_red</a></span>: <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">a</span>', <span class="id"><a href="CDF.FUN.html#ctx_red">ctx_red</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id">a</span>' -&gt; <span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id">a</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof137')">Proof.</div>
<div class="proofscript" id="proof137">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">REC</span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a</span>', <span class="id"><a href="CDF.FUN.html#head_red">head_red</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id">a</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">C</span>, <span class="id"><a href="CDF.FUN.html#iscontext">iscontext</a></span> <span class="id"><a href="CDF.FUN.html#C">C</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> (<span class="id"><a href="CDF.FUN.html#C">C</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>) (<span class="id"><a href="CDF.FUN.html#C">C</a></span> <span class="id">a</span>')).<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">a</span> <span class="id">a</span>' <span class="id">HR</span>; <span class="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">HR</span>; <span class="tactic">subst</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#red_app_1">red_app_1</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#red_app_2">red_app_2</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#red_cond_1">red_cond_1</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> 1. <span class="tactic">apply</span> <span class="id">REC</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="red_to_ctx_red">red_to_ctx_red</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">a</span>', <span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id">a</span>' -&gt; <span class="id"><a href="CDF.FUN.html#ctx_red">ctx_red</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id">a</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof138')">Proof.</div>
<div class="proofscript" id="proof138">
&nbsp;&nbsp;<span class="tactic">induction</span> 1.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#ctx_red_intro">ctx_red_intro</a></span> <span class="kwd">with</span> (<span class="id">C</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="CDF.FUN.html#x">x</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#head_red_beta">head_red_beta</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#ctx_red_intro">ctx_red_intro</a></span> <span class="kwd">with</span> (<span class="id">C</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="CDF.FUN.html#x">x</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#head_red_cond">head_red_cond</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">IHred</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#ctx_red_intro">ctx_red_intro</a></span> <span class="kwd">with</span> (<span class="id">C</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="CDF.FUN.html#App">App</a></span> (<span class="id">C</span> <span class="id"><a href="CDF.FUN.html#x">x</a></span>) <span class="id">a2</span>); <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#iscontext">iscontext</a></span>.<br/>
- <span class="tactic">destruct</span> <span class="id">IHred</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#ctx_red_intro">ctx_red_intro</a></span> <span class="kwd">with</span> (<span class="id">C</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="CDF.FUN.html#App">App</a></span> <span class="id">v</span> (<span class="id">C</span> <span class="id"><a href="CDF.FUN.html#x">x</a></span>)); <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#iscontext">iscontext</a></span>.<br/>
- <span class="tactic">destruct</span> <span class="id">IHred</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#ctx_red_intro">ctx_red_intro</a></span> <span class="kwd">with</span> (<span class="id">C</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="CDF.FUN.html#Cond">Cond</a></span> (<span class="id">C</span> <span class="id"><a href="CDF.FUN.html#x">x</a></span>) <span class="id">ifso</span> <span class="id">ifnot</span>); <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#iscontext">iscontext</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">La sémantique naturelle. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="eval">eval</a></span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#term">term</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="eval_abs">eval_abs</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#eval">eval</a></span> (<span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>) (<span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="eval_app">eval_app</a></span>: <span class="kwd">forall</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">x</span> <span class="id">a</span> <span class="id">v2</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#eval">eval</a></span> <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> (<span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>) -&gt; <span class="id"><a href="CDF.FUN.html#eval">eval</a></span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span> <span class="id"><a href="CDF.FUN.html#v2">v2</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#eval">eval</a></span> (<span class="tactic">subst</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#v2">v2</a></span>) <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#eval">eval</a></span> (<span class="id"><a href="CDF.FUN.html#App">App</a></span> <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span>) <span class="id"><a href="CDF.FUN.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="eval_const">eval_const</a></span>: <span class="kwd">forall</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#eval">eval</a></span> (<span class="id"><a href="CDF.FUN.html#Const">Const</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span>) (<span class="id"><a href="CDF.FUN.html#Const">Const</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="eval_cond">eval_cond</a></span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">ifso</span> <span class="id">ifnot</span> <span class="id">b</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#eval">eval</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> (<span class="id"><a href="CDF.FUN.html#Const">Const</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span>) -&gt; <span class="id"><a href="CDF.FUN.html#eval">eval</a></span> (<span class="kwd">if</span> <span class="id"><a href="CDF.FUN.html#b">b</a></span> <span class="kwd">then</span> <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="kwd">else</span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span>) <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#eval">eval</a></span> (<span class="id"><a href="CDF.FUN.html#Cond">Cond</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span>) <span class="id"><a href="CDF.FUN.html#v">v</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_isvalue">eval_isvalue</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">v</span>, <span class="id"><a href="CDF.FUN.html#eval">eval</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof139')">Proof.</div>
<div class="proofscript" id="proof139">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="isvalue_eval">isvalue_eval</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span>, <span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#eval">eval</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof140')">Proof.</div>
<div class="proofscript" id="proof140">
&nbsp;&nbsp;<span class="tactic">destruct</span> 1; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#eval">eval</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Equivalence entre sémantique naturelle <span class="bracket"><span class="id">eval</span> <span class="id">a</span> <span class="id">v</span></span> et sémantique à réductions
    (il existe une suite de réductions depuis <span class="bracket"><span class="id">a</span></span> vers la valeur <span class="bracket"><span class="id">v</span></span>). </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_reds">eval_reds</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">v</span>, <span class="id"><a href="CDF.FUN.html#eval">eval</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt; <span class="id"><a href="CDF.Sequences.html#star">star</a></span> <span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof141')">Proof.</div>
<div class="proofscript" id="proof141">
&nbsp;&nbsp;<span class="tactic">induction</span> 1.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="CDF.Sequences.html#star_refl">star_refl</a></span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="CDF.Sequences.html#star_trans">star_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="CDF.FUN.html#App">App</a></span> (<span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id">x</span> <span class="id">a</span>) <span class="id">a2</span>).<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">IHeval1</span>. <span class="tactic">generalize</span> <span class="id">a1</span>, (<span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id">x</span> <span class="id">a</span>). <span class="tactic">induction</span> 1; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.Sequences.html#star">star</a></span>, <span class="id"><a href="CDF.FUN.html#red_app_1">red_app_1</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.Sequences.html#star_trans">star_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="CDF.FUN.html#App">App</a></span> (<span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id">x</span> <span class="id">a</span>) <span class="id">v2</span>).<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">IHeval2</span>. <span class="tactic">generalize</span> <span class="id">a2</span>, <span class="id">v2</span>. <span class="tactic">induction</span> 1; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.Sequences.html#star">star</a></span>, <span class="id"><a href="CDF.FUN.html#red_app_2">red_app_2</a></span>, <span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="CDF.Sequences.html#star_step">star_step</a></span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#red_beta">red_beta</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="CDF.FUN.html#eval_isvalue">eval_isvalue</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHeval3</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="CDF.Sequences.html#star_refl">star_refl</a></span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="CDF.Sequences.html#star_trans">star_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="CDF.FUN.html#Cond">Cond</a></span> (<span class="id"><a href="CDF.FUN.html#Const">Const</a></span> <span class="id">b</span>) <span class="id">ifso</span> <span class="id">ifnot</span>).<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">IHeval1</span>. <span class="tactic">generalize</span> <span class="id">a</span>, (<span class="id"><a href="CDF.FUN.html#Const">Const</a></span> <span class="id">b</span>). <span class="tactic">induction</span> 1; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.Sequences.html#star">star</a></span>, <span class="id"><a href="CDF.FUN.html#red_cond_1">red_cond_1</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="CDF.Sequences.html#star_step">star_step</a></span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#red_cond">red_cond</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHeval2</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="red_eval_eval">red_eval_eval</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a1</span> <span class="id">a2</span>, <span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span> -&gt; <span class="kwd">forall</span> <span class="id">v</span>, <span class="id"><a href="CDF.FUN.html#eval">eval</a></span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#eval">eval</a></span> <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof142')">Proof.</div>
<div class="proofscript" id="proof142">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span> <span class="id">v</span>' <span class="id">E</span>.<br/>
- <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#eval">eval</a></span>, <span class="id"><a href="CDF.FUN.html#isvalue_eval">isvalue_eval</a></span>.<br/>
- <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#eval">eval</a></span>.<br/>
- <span class="tactic">inversion</span> <span class="id">E</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#eval">eval</a></span>.<br/>
- <span class="tactic">inversion</span> <span class="id">E</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#eval">eval</a></span>, <span class="id"><a href="CDF.FUN.html#isvalue_eval">isvalue_eval</a></span>.<br/>
- <span class="tactic">inversion</span> <span class="id">E</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#eval">eval</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="reds_eval">reds_eval</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">v</span>, <span class="id"><a href="CDF.Sequences.html#star">star</a></span> <span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#eval">eval</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof143')">Proof.</div>
<div class="proofscript" id="proof143">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#isvalue_eval">isvalue_eval</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#red_eval_eval">red_eval_eval</a></span> <span class="kwd">with</span> <span class="id">b</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> 7.2.  Typage simple </h2>
<br/>
<div class="doc">L'algèbre des types. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="type">type</a></span>: <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Bool">Bool</a></span>                          <span class="docright">(* type des booléens  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Fun">Fun</a></span> (<span class="id">t1</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>) (<span class="id">t2</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>).    <span class="docright">(* type des fonctions de <span class="bracket"><span class="id">t1</span></span> dans <span class="bracket"><span class="id">t2</span></span>  *)</span><br/>
<br/>
<span class="kwd">Notation</span> " <span class="id">t1</span> --&gt; <span class="id">t2</span> " := (<span class="id"><a href="CDF.FUN.html#Fun">Fun</a></span> <span class="id">t1</span> <span class="id">t2</span>) (<span class="id">right</span> <span class="id">associativity</span>, <span class="tactic">at</span> <span class="id">level</span> 55).<br/>
<br/>
<div class="doc">Les contextes de typage, associant un type à chaque variable. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="context">context</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> * <span class="id"><a href="CDF.FUN.html#type">type</a></span>).<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="lookup">lookup</a></span> {<span class="id">A</span>: <span class="kwd">Type</span>} (<span class="id">x</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> * <span class="id"><a href="CDF.FUN.html#A">A</a></span>)) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CDF.FUN.html#A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CDF.FUN.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| (<span class="id">y</span>, <span class="id">a</span>) :: <span class="id">l</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id">y</span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">a</span> <span class="kwd">else</span> <span class="id"><a href="CDF.FUN.html#lookup">lookup</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#l">l</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Les règles de typage. </div>
<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">E</span> '⊢' <span class="id">a</span> '∈' <span class="id">t</span>" (<span class="tactic">at</span> <span class="id">level</span> 40).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="has_type">has_type</a></span> : <span class="id"><a href="CDF.FUN.html#context">context</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#term">term</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#type">type</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="T_Var">T_Var</a></span>: <span class="kwd">forall</span> <span class="id">E</span> <span class="id">x</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#lookup">lookup</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#Var">Var</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="T_Abs">T_Abs</a></span> : <span class="kwd">forall</span> <span class="id">E</span> <span class="id">x</span> <span class="id">a</span> <span class="id">t</span> <span class="id">t</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="CDF.FUN.html#x">x</a></span>, <span class="id"><a href="CDF.FUN.html#t">t</a></span>) :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id">t</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> <span class="id">t</span>'<br/>
&nbsp;&nbsp;| <span class="id"><a name="T_App">T_App</a></span> : <span class="kwd">forall</span> <span class="id">E</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">t</span> <span class="id">t</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> ∈ <span class="id"><a href="CDF.FUN.html#Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> <span class="id">t</span>' -&gt; <span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a2">a2</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#App">App</a></span> <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span> ∈ <span class="id">t</span>'<br/>
&nbsp;&nbsp;| <span class="id"><a name="T_Const">T_Const</a></span> : <span class="kwd">forall</span> <span class="id">E</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#Const">Const</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span> ∈ <span class="id"><a href="CDF.FUN.html#Bool">Bool</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="T_Cond">T_Cond</a></span> : <span class="kwd">forall</span> <span class="id">E</span> <span class="id">a</span> <span class="id">ifso</span> <span class="id">ifnot</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#Bool">Bool</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#Cond">Cond</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span><br/>
<br/>
<span class="kwd">where</span> "<span class="id">E</span> '⊢' <span class="id">a</span> '∈' <span class="id">t</span>" := (<span class="id"><a href="CDF.FUN.html#has_type">has_type</a></span> <span class="id">E</span> <span class="id">a</span> <span class="id">t</span>).<br/>
<br/>
<div class="doc">Les principales propriétés du jugement de typage.
    Tout d'abord, l'affaiblissement. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="weakening">weakening</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">E</span> <span class="id">a</span> <span class="id">t</span>, <br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">E</span>',<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">tx</span>, <span class="id"><a href="CDF.FUN.html#lookup">lookup</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="CDF.FUN.html#tx">tx</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#lookup">lookup</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id">E</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="CDF.FUN.html#tx">tx</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">E</span>' ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof144')">Proof.</div>
<div class="proofscript" id="proof144">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span> <span class="id">E</span>' <span class="id">W</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#has_type">has_type</a></span>.<br/>
- <span class="comment">(*&nbsp;Abs&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#T_Abs">T_Abs</a></span>. <span class="tactic">apply</span> <span class="id">IHhas_type</span>.<br/>
&nbsp;&nbsp;<span class="id">cbn</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">x0</span> <span class="id">x</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">L'affaiblissement est énoncé de manière inhabituelle.
    D'ordinaire, on l'exprime avec une concaténation syntaxique de
    contexte: si <span class="bracket"><span class="id">E</span> ⊢ <span class="id">a</span> ∈ <span class="id">t</span></span> alors <span class="bracket"><span class="id">E</span>' ++ <span class="id">E</span> ⊢ <span class="id">a</span> ∈ <span class="id">t</span></span>.  Mais cet énoncé
    est faux si <span class="bracket"><span class="id">E</span>'</span> peut lier des variables déjà liées dans <span class="bracket"><span class="id">E</span></span>.
    Sur papier on a des contraintes implicites qu'un contexte ne lie
    jamais deux fois la même variable, contraintes qui peuvent
    toujours être satisfaites par renommage.
    Dans notre développement Coq, nous n'avons pas de renommage, ni de
    contraintes de linéarité sur les contextes.  A la place, nous
    utilisons deux contextes <span class="bracket"><span class="id">E</span></span> et <span class="bracket"><span class="id">E</span>'</span> et les relions par l'hypothèse
    "toutes les variables qui ont un type dans <span class="bracket"><span class="id">E</span></span> ont le même type dans <span class="bracket"><span class="id">E</span>'</span>".
</div>
<br/>
<div class="doc">Le lemme de stabilité du typage par substitution utilise la même
    astuce pour relier
<ul>
<li>
   le contexte <span class="bracket"><span class="id">E</span></span> dans lequel le terme <span class="bracket"><span class="id">a</span></span> est typé avant substitution;
</li>
<li>
   le contexte <span class="bracket"><span class="id">E</span>'</span> dans lequel le terme <span class="bracket"><span class="tactic">subst</span> <span class="id">a</span> <span class="id">x</span> <span class="id">c</span></span> est typé après
    substitution.
</li>
</ul>
    De plus, le lemme exige que <span class="bracket"><span class="id">c</span></span> soit typé dans l'environnement
    vide, ce qui garantit qu'il est clos. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="substitution_preserves_typing">substitution_preserves_typing</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">E</span> <span class="id">a</span> <span class="id">t</span>, <br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">c</span> <span class="id">t</span>' <span class="id">E</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#c">c</a></span> ∈ <span class="id">t</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#lookup">lookup</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">t</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">y</span> <span class="id">ty</span>, <span class="id"><a href="CDF.FUN.html#y">y</a></span> &lt;&gt; <span class="id"><a href="CDF.FUN.html#x">x</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#lookup">lookup</a></span> <span class="id"><a href="CDF.FUN.html#y">y</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="CDF.FUN.html#ty">ty</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#lookup">lookup</a></span> <span class="id"><a href="CDF.FUN.html#y">y</a></span> <span class="id">E</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="CDF.FUN.html#ty">ty</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">E</span>' ⊢ <span class="tactic">subst</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#c">c</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof145')">Proof.</div>
<div class="proofscript" id="proof145">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span> <span class="id">until</span> <span class="id">E</span>'; <span class="tactic">intros</span> <span class="id">TYC</span> <span class="id">TYX</span> <span class="id">TYE</span>; <span class="id">cbn</span>.<br/>
- <span class="comment">(*&nbsp;Var&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">x0</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Var&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">t</span> <span class="kwd">with</span> <span class="id">t</span>' <span class="tactic">by</span> <span class="tactic">congruence</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#weakening">weakening</a></span> <span class="kwd">with</span> (<span class="id">E</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cbn</span>; <span class="tactic">intros</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Var&nbsp;y,&nbsp;y&nbsp;&lt;&gt;&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#T_Var">T_Var</a></span>. <span class="tactic">apply</span> <span class="id">TYE</span>; <span class="tactic">auto</span>.<br/>
- <span class="comment">(*&nbsp;Abs&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">x0</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Abs&nbsp;x&nbsp;a&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">x0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#T_Abs">T_Abs</a></span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#weakening">weakening</a></span> <span class="kwd">with</span> (<span class="id">E</span> := (<span class="id">x</span>, <span class="id">t</span>) :: <span class="id">E</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cbn</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">x0</span> <span class="id">x</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Abs&nbsp;y&nbsp;a,&nbsp;y&nbsp;&lt;&gt;&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#T_Abs">T_Abs</a></span>. <span class="tactic">eapply</span> <span class="id">IHhas_type</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cbn</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">x0</span> <span class="id">x</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cbn</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">y</span> <span class="id">x</span>); <span class="tactic">auto</span>.<br/>
- <span class="comment">(*&nbsp;App&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#T_App">T_App</a></span> <span class="kwd">with</span> <span class="id">t</span>; <span class="tactic">eauto</span>.<br/>
- <span class="comment">(*&nbsp;Const&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#T_Const">T_Const</a></span>.<br/>
- <span class="comment">(*&nbsp;Cond&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#T_Cond">T_Cond</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Enfin, voici comment le type des valeurs closes détermine leur forme. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="canonical_forms">canonical_forms</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#v">v</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Bool">Bool</a></span> =&gt; <span class="id">exists</span> <span class="id">b</span>, <span class="id"><a href="CDF.FUN.html#v">v</a></span> = <span class="id"><a href="CDF.FUN.html#Const">Const</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Fun">Fun</a></span> <span class="id">t1</span> <span class="id">t2</span> =&gt; <span class="id">exists</span> <span class="id">x</span> <span class="id">a</span>, <span class="id"><a href="CDF.FUN.html#v">v</a></span> = <span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof146')">Proof.</div>
<div class="proofscript" id="proof146">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">v</span> <span class="id">t</span> <span class="id">TY</span> <span class="id">VAL</span>. <span class="tactic">inversion</span> <span class="id">VAL</span>; <span class="tactic">subst</span>; <span class="tactic">inversion</span> <span class="id">TY</span>; <span class="tactic">subst</span>.<br/>
- <span class="comment">(*&nbsp;Fun&nbsp;type&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x</span>, <span class="id">a</span>; <span class="tactic">auto</span>.<br/>
- <span class="comment">(*&nbsp;Bool&nbsp;type&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">On peut alors montrer les deux propriétés essentielles qui relient
    typage et réductions: préservation et progression. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="reduction_preserves_typing">reduction_preserves_typing</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">a</span>',<br/>
&nbsp;&nbsp;<span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id">a</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ⊢ <span class="id">a</span>' ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof147')">Proof.</div>
<div class="proofscript" id="proof147">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span> <span class="id">t</span> <span class="id">TY</span>.<br/>
- <span class="comment">(*&nbsp;red_beta&nbsp;*)</span> <br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">TY</span>; <span class="tactic">subst</span>. <span class="tactic">inversion</span> <span class="id">H3</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="CDF.FUN.html#substitution_preserves_typing">substitution_preserves_typing</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">cbn</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">x</span> <span class="id">x</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">cbn</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">y</span> <span class="id">x</span>); <span class="tactic">congruence</span>.<br/>
- <span class="comment">(*&nbsp;red_cond&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">TY</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">auto</span>.<br/>
- <span class="comment">(*&nbsp;red_app_1&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">TY</span>; <span class="tactic">subst</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#T_App">T_App</a></span> <span class="kwd">with</span> <span class="id">t0</span>; <span class="tactic">eauto</span>. <br/>
- <span class="comment">(*&nbsp;red_app_2&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">TY</span>; <span class="tactic">subst</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#T_App">T_App</a></span> <span class="kwd">with</span> <span class="id">t0</span>; <span class="tactic">eauto</span>. <br/>
- <span class="comment">(*&nbsp;red_cond_1&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">TY</span>; <span class="tactic">subst</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#T_Cond">T_Cond</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="tactic">progress</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> \/ <span class="id">exists</span> <span class="id">a</span>', <span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id">a</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof148')">Proof.</div>
<div class="proofscript" id="proof148">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">a</span> <span class="id">t</span> <span class="id">TY</span>; <span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">TY</span>.<br/>
- <span class="comment">(*&nbsp;Abs&nbsp;x&nbsp;a&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#V_Abs">V_Abs</a></span>.<br/>
- <span class="comment">(*&nbsp;App&nbsp;a1&nbsp;a2&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHTY1</span> <span class="kwd">as</span> [<span class="id">ISVAL1</span> | (<span class="id">a1</span>' &amp; <span class="id">RED1</span>)]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">IHTY2</span> <span class="kwd">as</span> [<span class="id">ISVAL2</span> | (<span class="id">a2</span>' &amp; <span class="id">RED2</span>)]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;a1&nbsp;et&nbsp;a2&nbsp;sont&nbsp;des&nbsp;valeurs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CDF.FUN.html#canonical_forms">canonical_forms</a></span> <span class="id">a1</span> (<span class="id"><a href="CDF.FUN.html#Fun">Fun</a></span> <span class="id">t</span> <span class="id">t</span>')) <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">a</span> &amp; <span class="id">E</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">a1</span>. <span class="id">right</span>; <span class="id">exists</span> (<span class="tactic">subst</span> <span class="id">a</span> <span class="id">x</span> <span class="id">a2</span>). <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#red_beta">red_beta</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;a1&nbsp;est&nbsp;une&nbsp;valeur,&nbsp;a2&nbsp;se&nbsp;réduit&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#App">App</a></span> <span class="id">a1</span> <span class="id">a2</span>'). <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#red_app_2">red_app_2</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;a1&nbsp;se&nbsp;réduit&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#App">App</a></span> <span class="id">a1</span>' <span class="id">a2</span>). <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#red_app_1">red_app_1</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="comment">(*&nbsp;Const&nbsp;b&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#V_Const">V_Const</a></span>.<br/>
- <span class="comment">(*&nbsp;Cond&nbsp;a&nbsp;ifso&nbsp;ifnot&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHTY1</span> <span class="kwd">as</span> [<span class="id">ISVAL1</span> | (<span class="id">a</span>' &amp; <span class="id">RED1</span>)]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;a&nbsp;est&nbsp;une&nbsp;valeur&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CDF.FUN.html#canonical_forms">canonical_forms</a></span> <span class="id">a</span> <span class="id"><a href="CDF.FUN.html#Bool">Bool</a></span>) <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">E</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">a</span>. <span class="id">right</span>; <span class="id">exists</span> (<span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id">ifso</span> <span class="kwd">else</span> <span class="id">ifnot</span>). <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#red_cond">red_cond</a></span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;a&nbsp;se&nbsp;réduit&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#Cond">Cond</a></span> <span class="id">a</span>' <span class="id">ifso</span> <span class="id">ifnot</span>). <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#red_cond_1">red_cond_1</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Il s'ensuit qu'un terme bien typé ne peut pas faire d'erreurs
    ("does not go wrong"). </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="goes_wrong">goes_wrong</a></span> (<span class="id">a</span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span>', <span class="id"><a href="CDF.Sequences.html#star">star</a></span> <span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id">a</span>' /\ <span class="id"><a href="CDF.Sequences.html#irred">irred</a></span> <span class="tactic">red</span> <span class="id">a</span>' /\ ~<span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> <span class="id">a</span>'.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="well_typed_programs_do_not_go_wrong">well_typed_programs_do_not_go_wrong</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; ~ <span class="id"><a href="CDF.FUN.html#goes_wrong">goes_wrong</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof149')">Proof.</div>
<div class="proofscript" id="proof149">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">a</span> <span class="id">t</span> <span class="id">TY</span> (<span class="id">a</span>' &amp; <span class="id">REDS</span> &amp; <span class="id">IRRED</span> &amp; <span class="id">NOTVAL</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">TY</span>': <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ⊢ <span class="id">a</span>' ∈ <span class="id">t</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">clear</span> <span class="id">IRRED</span> <span class="id">NOTVAL</span>. <span class="id">revert</span> <span class="id">a</span> <span class="id">a</span>' <span class="id">REDS</span> <span class="id">TY</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#reduction_preserves_typing">reduction_preserves_typing</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="tactic">progress</span> <span class="id">a</span>' <span class="id">t</span> <span class="id">TY</span>') <span class="kwd">as</span> [<span class="id">ISVAL</span> | (<span class="id">a</span>'' &amp; <span class="id">RED</span>)].<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">NOTVAL</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">IRRED</span> <span class="kwd">with</span> <span class="id">a</span>''. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Une présentation plus positive du même résultat.  On définit
    coinductivement le prédicat <span class="bracket"><span class="id">safe</span> <span class="id">a</span></span>, signifiant "a s'exécute sans
    faire d'erreurs".  Il recouvre à la fois le cas où la réduction de
    <span class="bracket"><span class="id">a</span></span> termine sans erreur sur une valeur, et le cas où la réduction
    de <span class="bracket"><span class="id">a</span></span> diverge. </div>
<br/>
<span class="kwd">CoInductive</span> <span class="id"><a name="safe">safe</a></span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="safe_value">safe_value</a></span>: <span class="kwd">forall</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#safe">safe</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="safe_red">safe_red</a></span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id">a</span>' -&gt; <span class="id"><a href="CDF.FUN.html#safe">safe</a></span> <span class="id">a</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#safe">safe</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="well_typed_programs_are_safe">well_typed_programs_are_safe</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#safe">safe</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof150')">Proof.</div>
<div class="proofscript" id="proof150">
&nbsp;&nbsp;<span class="id">cofix</span> <span class="id">CIH</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="tactic">progress</span> <span class="id">a</span> <span class="id">t</span> <span class="id">H</span>) <span class="kwd">as</span> [<span class="id">ISVAL</span> | (<span class="id">a</span>' &amp; <span class="id">RED</span>)].<br/>
- <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#safe_value">safe_value</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#safe_red">safe_red</a></span> <span class="kwd">with</span> <span class="id">a</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">CIH</span> <span class="kwd">with</span> <span class="id">t</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#reduction_preserves_typing">reduction_preserves_typing</a></span> <span class="kwd">with</span> <span class="id">a</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h3> Exercice (2 à 3 étoiles). </h3>
<div class="doc">Enrichir le système de type pour y ajouter une ou plusieurs des extensions
    vues en cours: entiers de Peano, produits, sommes, points fixes.
    Adapter la démonstration de sûreté du typage. </div>
<br/>
<h3> Exercice (3 étoiles). </h3>
<div class="doc">Dans la définition de l'algèbre de types, remplacer <span class="bracket"><span class="kwd">Inductive</span> <span class="id">type</span> ...</span>
    par <span class="bracket"><span class="kwd">CoInductive</span> <span class="id">type</span> ...</span>.
    Cela permet d'avoir des expressions de types infinies, comme p.ex.
    <span class="bracket"><span class="id">Bool</span> --&gt; <span class="id">Bool</span> --&gt; ... --&gt; <span class="id">Bool</span> --&gt; ...</span>.
<ul>
<li>
   Vérifier que la sûreté du typage est inchangée.
</li>
<li>
   Montrer que l'on peut typer le combinateur de point fixe <span class="bracket"><span class="id">Y</span></span> donné
    dans le cours avec le type <span class="bracket">(<span class="id">t</span> --&gt; <span class="id">t</span>) --&gt; <span class="id">t</span></span> pour tout type <span class="bracket"><span class="id">t</span></span>. </li>
</ul>
</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="type_Y">type_Y</a></span>: <span class="kwd">forall</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">D</span> := <span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> "<span class="id">x</span>" (<span class="id"><a href="CDF.FUN.html#App">App</a></span> (<span class="id"><a href="CDF.FUN.html#Var">Var</a></span> "<span class="id">f</span>") (<span class="id"><a href="CDF.FUN.html#App">App</a></span> (<span class="id"><a href="CDF.FUN.html#Var">Var</a></span> "<span class="id">x</span>") (<span class="id"><a href="CDF.FUN.html#Var">Var</a></span> "<span class="id">x</span>"))) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Y</span> := <span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> "<span class="id">f</span>" (<span class="id"><a href="CDF.FUN.html#App">App</a></span> <span class="id"><a href="CDF.FUN.html#D">D</a></span> <span class="id"><a href="CDF.FUN.html#D">D</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#Y">Y</a></span> ∈ ((<span class="id"><a href="CDF.FUN.html#t">t</a></span> --&gt; <span class="id"><a href="CDF.FUN.html#t">t</a></span>) --&gt; <span class="id"><a href="CDF.FUN.html#t">t</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof151')">Proof.</div>
<div class="proofscript" id="proof151">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span> <span class="id">D</span> <span class="id">Y</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;A&nbsp;COMPLETER&nbsp;*)</span><br/>
Abort.</div>
<br/>
<h3> Exercice (3 étoiles) </h3>
<div class="doc">Écrire un typeur pour ce système de types: une fonction
    de type <span class="bracket"><span class="id">context</span> -&gt; <span class="id">term</span> -&gt; <span class="id">option</span> <span class="id">type</span></span>
    qui vérifie si un terme est bien typé dans un contexte donné.
    Si oui, le type du terme est renvoyé; si non, <span class="bracket"><span class="id">None</span></span> est renvoyé.
    Montrer que ce typeur est sûr et complet vis-à-vis des règles de typage.
</div>
<span class="kwd">Fixpoint</span> <span class="id"><a name="typecheck">typecheck</a></span> (<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#context">context</a></span>) (<span class="id">a</span>: <span class="id"><a href="CDF.FUN.html#term">term</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CDF.FUN.html#type">type</a></span> :=<br/>
 <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="typecheck_sound">typecheck_sound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">E</span> <span class="id">a</span> <span class="id">t</span>, <span class="id"><a href="CDF.FUN.html#typecheck">typecheck</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#has_type">has_type</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof152')">Proof.</div>
<div class="proofscript" id="proof152">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">E</span> <span class="id">a</span>; <span class="id">revert</span> <span class="id">a</span> <span class="id">E</span>; <span class="tactic">induction</span> <span class="id">a</span>; <span class="id">cbn</span>; <span class="tactic">intros</span> <span class="id">E</span> <span class="id">t</span> <span class="id">T</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;A&nbsp;COMPLETER&nbsp;*)</span><br/>
Abort.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="typecheck_complete">typecheck_complete</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">E</span> <span class="id">a</span> <span class="id">t</span>, <span class="id"><a href="CDF.FUN.html#has_type">has_type</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#typecheck">typecheck</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof153')">Proof.</div>
<div class="proofscript" id="proof153">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="id">cbn</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;A&nbsp;COMPLETER&nbsp;*)</span><br/>
Abort.</div>
<br/>
<h2> 7.3.  Sous-typage </h2>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="Subtyping">Subtyping</a></span>.<br/>
<br/>
<div class="doc">On enrichit l'algèbre des types avec un type <span class="bracket"><span class="id">Top</span></span> de toutes les valeurs. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="Subtyping.type">type</a></span>: <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Subtyping.Top">Top</a></span>                           <span class="docright">(* type universel  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Subtyping.Bool">Bool</a></span>                          <span class="docright">(* type des booléens  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Subtyping.Fun">Fun</a></span> (<span class="id">t1</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>) (<span class="id">t2</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>).    <span class="docright">(* type des fonctions de <span class="bracket"><span class="id">t1</span></span> dans <span class="bracket"><span class="id">t2</span></span>  *)</span><br/>
<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">t</span> '&lt;:' <span class="id">s</span>" (<span class="tactic">at</span> <span class="id">level</span> 40).<br/>
<br/>
<div class="doc">La relation de sous-typage.  Intuitivement, <span class="bracket"><span class="id">t</span></span> est sous-type de <span class="bracket"><span class="id">s</span></span>
    si toute valeur de type <span class="bracket"><span class="id">t</span></span> peut être utilisée avec le type <span class="bracket"><span class="id">s</span></span>. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="Subtyping.subtype">subtype</a></span>: <span class="id"><a href="CDF.FUN.html#Subtyping.type">type</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#Subtyping.type">type</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Subtyping.subtype_top">subtype_top</a></span>: <span class="kwd">forall</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#t">t</a></span> &lt;: <span class="id"><a href="CDF.FUN.html#Subtyping.Top">Top</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Subtyping.subtype_bool">subtype_bool</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#Subtyping.Bool">Bool</a></span> &lt;: <span class="id"><a href="CDF.FUN.html#Subtyping.Bool">Bool</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Subtyping.subtype_fun">subtype_fun</a></span>: <span class="kwd">forall</span> <span class="id">s1</span> <span class="id">t1</span> <span class="id">s2</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#s2">s2</a></span> &lt;: <span class="id"><a href="CDF.FUN.html#s1">s1</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#t1">t1</a></span> &lt;: <span class="id"><a href="CDF.FUN.html#t2">t2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#Subtyping.Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#s1">s1</a></span> <span class="id"><a href="CDF.FUN.html#t1">t1</a></span> &lt;: <span class="id"><a href="CDF.FUN.html#Subtyping.Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#s2">s2</a></span> <span class="id"><a href="CDF.FUN.html#t2">t2</a></span><br/>
<br/>
<span class="kwd">where</span> "<span class="id">t</span> '&lt;:' <span class="id">s</span>" := (<span class="id"><a href="CDF.FUN.html#subtype">subtype</a></span> <span class="id">t</span> <span class="id">s</span>).<br/>
<br/>
<div class="doc">Tout type est sous-type de lui-même. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Subtyping.subtype_refl">subtype_refl</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="CDF.FUN.html#t">t</a></span> &lt;: <span class="id"><a href="CDF.FUN.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof154')">Proof.</div>
<div class="proofscript" id="proof154">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">t</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#Subtyping.subtype">subtype</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">La relation de sous-typage est transitive. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Subtyping.subtype_trans">subtype_trans</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span>, <span class="id"><a href="CDF.FUN.html#t1">t1</a></span> &lt;: <span class="id"><a href="CDF.FUN.html#t2">t2</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#t2">t2</a></span> &lt;: <span class="id"><a href="CDF.FUN.html#t3">t3</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#t1">t1</a></span> &lt;: <span class="id"><a href="CDF.FUN.html#t3">t3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof155')">Proof.</div>
<div class="proofscript" id="proof155">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t1</span> <span class="id">t2</span>; <span class="id">revert</span> <span class="id">t2</span> <span class="id">t1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">t2</span>; <span class="tactic">intros</span> <span class="id">t1</span> <span class="id">t3</span> <span class="id">S1</span> <span class="id">S2</span>; <br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">S1</span>; <span class="tactic">inversion</span> <span class="id">S2</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#Subtyping.subtype">subtype</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">On ajoute au système de types une règle de subsomption <span class="bracket"><span class="id">T_Sub</span></span>
    qui permet d'utiliser un terme avec un super-type de son type. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Subtyping.context">context</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> * <span class="id"><a href="CDF.FUN.html#Subtyping.type">type</a></span>).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="Subtyping.has_type">has_type</a></span> : <span class="id"><a href="CDF.FUN.html#Subtyping.context">context</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#term">term</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#Subtyping.type">type</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Subtyping.T_Var">T_Var</a></span>: <span class="kwd">forall</span> <span class="id">E</span> <span class="id">x</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#lookup">lookup</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#Var">Var</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Subtyping.T_Abs">T_Abs</a></span> : <span class="kwd">forall</span> <span class="id">E</span> <span class="id">x</span> <span class="id">a</span> <span class="id">t</span> <span class="id">t</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="CDF.FUN.html#x">x</a></span>, <span class="id"><a href="CDF.FUN.html#t">t</a></span>) :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id">t</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#Subtyping.Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> <span class="id">t</span>'<br/>
&nbsp;&nbsp;| <span class="id"><a name="Subtyping.T_App">T_App</a></span> : <span class="kwd">forall</span> <span class="id">E</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">t</span> <span class="id">t</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> ∈ <span class="id"><a href="CDF.FUN.html#Subtyping.Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> <span class="id">t</span>' -&gt; <span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a2">a2</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#App">App</a></span> <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span> ∈ <span class="id">t</span>'<br/>
&nbsp;&nbsp;| <span class="id"><a name="Subtyping.T_Const">T_Const</a></span> : <span class="kwd">forall</span> <span class="id">E</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#Const">Const</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span> ∈ <span class="id"><a href="CDF.FUN.html#Subtyping.Bool">Bool</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Subtyping.T_Cond">T_Cond</a></span> : <span class="kwd">forall</span> <span class="id">E</span> <span class="id">a</span> <span class="id">ifso</span> <span class="id">ifnot</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#Subtyping.Bool">Bool</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#Cond">Cond</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Subtyping.T_Sub">T_Sub</a></span>: <span class="kwd">forall</span> <span class="id">E</span> <span class="id">a</span> <span class="id">s</span> <span class="id">t</span>,       <span class="docright">(* &lt;-- nouveau!  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#s">s</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#s">s</a></span> &lt;: <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span><br/>
<br/>
<span class="kwd">where</span> "<span class="id">E</span> '⊢' <span class="id">a</span> '∈' <span class="id">t</span>" := (<span class="id"><a href="CDF.FUN.html#has_type">has_type</a></span> <span class="id">E</span> <span class="id">a</span> <span class="id">t</span>).<br/>
<br/>
<h3> Exercice (4 étoiles). </h3>
<div class="doc">Montrer la sûreté de ce système de types avec sous-typage.
    On peut réutiliser une très grande partie de la démonstration de
    la section 7.2.  Il faudra cependant utiliser les lemmes
    d'inversion suivants. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Subtyping.T_Abs_inv">T_Abs_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">E</span> <span class="id">x</span> <span class="id">a</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#Abs">Abs</a></span> <span class="id"><a href="CDF.FUN.html#x">x</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="id">exists</span> <span class="id">t1</span> <span class="id">t2</span>, ((<span class="id"><a href="CDF.FUN.html#x">x</a></span>, <span class="id"><a href="CDF.FUN.html#t1">t1</a></span>) :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t2">t2</a></span> /\ <span class="id"><a href="CDF.FUN.html#Subtyping.Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#t1">t1</a></span> <span class="id"><a href="CDF.FUN.html#t2">t2</a></span> &lt;: <span class="id"><a href="CDF.FUN.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof156')">Proof.</div>
<div class="proofscript" id="proof156">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">t</span>; <span class="tactic">intros</span> <span class="id">TY</span>; <span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">TY</span>.<br/>
- <span class="id">exists</span> <span class="id">t</span>, <span class="id">t</span>'; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#Subtyping.subtype_refl">subtype_refl</a></span>.<br/>
- <span class="id">edestruct</span> <span class="id">IHTY</span> <span class="kwd">as</span> (<span class="id">t1</span> &amp; <span class="id">t2</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">t1</span>, <span class="id">t2</span>; <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#Subtyping.subtype_trans">subtype_trans</a></span> <span class="kwd">with</span> <span class="id">s</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Subtyping.T_App_inv">T_App_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">E</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#App">App</a></span> <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="id">exists</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> ∈ <span class="id"><a href="CDF.FUN.html#Subtyping.Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#t1">t1</a></span> <span class="id"><a href="CDF.FUN.html#t2">t2</a></span> /\ <span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a2">a2</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t1">t1</a></span> /\ <span class="id"><a href="CDF.FUN.html#t2">t2</a></span> &lt;: <span class="id"><a href="CDF.FUN.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof157')">Proof.</div>
<div class="proofscript" id="proof157">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">t</span>; <span class="tactic">intros</span> <span class="id">TY</span>; <span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">TY</span>.<br/>
- <span class="id">exists</span> <span class="id">t</span>, <span class="id">t</span>'; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#Subtyping.subtype_refl">subtype_refl</a></span>.<br/>
- <span class="id">edestruct</span> <span class="id">IHTY</span> <span class="kwd">as</span> (<span class="id">t1</span> &amp; <span class="id">t2</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">t1</span>, <span class="id">t2</span>; <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#Subtyping.subtype_trans">subtype_trans</a></span> <span class="kwd">with</span> <span class="id">s</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Subtyping.T_Cond_inv">T_Cond_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">E</span> <span class="id">a</span> <span class="id">ifso</span> <span class="id">ifnot</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#Cond">Cond</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="id">exists</span> <span class="id">t</span>', <span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#Subtyping.Bool">Bool</a></span> /\ <span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> ∈ <span class="id">t</span>' /\ <span class="id"><a href="CDF.FUN.html#E">E</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span> ∈ <span class="id">t</span>' /\ <span class="id">t</span>' &lt;: <span class="id"><a href="CDF.FUN.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof158')">Proof.</div>
<div class="proofscript" id="proof158">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">t</span>; <span class="tactic">intros</span> <span class="id">TY</span>; <span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">TY</span>.<br/>
- <span class="id">exists</span> <span class="id">t</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.FUN.html#Subtyping.subtype_refl">subtype_refl</a></span>.<br/>
- <span class="id">edestruct</span> <span class="id">IHTY</span> <span class="kwd">as</span> (<span class="id">t</span>' &amp; <span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span> &amp; <span class="id">S</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">t</span>'; <span class="tactic">intuition</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#Subtyping.subtype_trans">subtype_trans</a></span> <span class="kwd">with</span> <span class="id">s</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Subtyping.well_typed_programs_are_safe">well_typed_programs_are_safe</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ⊢ <span class="id"><a href="CDF.FUN.html#a">a</a></span> ∈ <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#safe">safe</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof159')">Proof.</div>
<div class="proofscript" id="proof159">
&nbsp;&nbsp;<span class="comment">(*&nbsp;A&nbsp;COMPLETER&nbsp;*)</span><br/>
Abort.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CDF.FUN.html#Subtyping">Subtyping</a></span>.<br/>
<br/>
<h2> 7.4.  Termes intrinsiquement typés </h2>
<br/>
<span class="id">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html">FunctionalExtensionality</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="Intrinsic">Intrinsic</a></span>.<br/>
<br/>
<div class="doc">Nous développons maintenant une syntaxe abstraite pour FUN où les
    termes sont indicés par leur type et par le contexte dans lequel
    ils sont typés.  </div>
<br/>
<div class="doc">Le contexte liste les variables libres qui peuvent apparaître dans
    le terme, avec leur type.  Nous utilisons une notation
    positionnelle (les indices de de Bruijn) pour les variables,
    ce qui fait que le contexte est simplement une liste de types:
    <span class="bracket"><span class="id">t1</span> :: ... :: <span class="id">tN</span> :: <span class="id">nil</span></span> est le contexte qui donne le type <span class="bracket"><span class="id">ti</span></span>
    à la variable d'indice <span class="bracket"><span class="id">i</span></span>, pour <span class="bracket"><span class="id">i</span></span> allant de 1 à <span class="bracket"><span class="id">N</span></span>. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Intrinsic.context">context</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CDF.FUN.html#type">type</a></span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">var</span> <span class="id">E</span> <span class="id">t</span></span> est le type des variables utilisables dans le contexte <span class="bracket"><span class="id">E</span></span>
    avec le type <span class="bracket"><span class="id">t</span></span>. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="Intrinsic.var">var</a></span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#type">type</a></span> -&gt; <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Intrinsic.V1">V1</a></span>: <span class="kwd">forall</span> {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>}, <span class="id"><a href="CDF.FUN.html#var">var</a></span> (<span class="id"><a href="CDF.FUN.html#t">t</a></span> :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t">t</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Intrinsic.VS">VS</a></span>: <span class="kwd">forall</span> {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span> <span class="id">t</span>': <span class="id"><a href="CDF.FUN.html#type">type</a></span>}, <span class="id"><a href="CDF.FUN.html#var">var</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id">t</span>' -&gt; <span class="id"><a href="CDF.FUN.html#var">var</a></span> (<span class="id"><a href="CDF.FUN.html#t">t</a></span> :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id">t</span>'.<br/>
<br/>
<div class="doc">Exemples de variables. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Intrinsic.V2">V2</a></span> {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t1</span> <span class="id">t2</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>}: <span class="id"><a href="CDF.FUN.html#Intrinsic.var">var</a></span> (<span class="id"><a href="CDF.FUN.html#t1">t1</a></span> :: <span class="id"><a href="CDF.FUN.html#t2">t2</a></span> :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t2">t2</a></span> := <span class="id"><a href="CDF.FUN.html#Intrinsic.VS">VS</a></span> <span class="id"><a href="CDF.FUN.html#Intrinsic.V1">V1</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Intrinsic.V3">V3</a></span> {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>}: <span class="id"><a href="CDF.FUN.html#Intrinsic.var">var</a></span> (<span class="id"><a href="CDF.FUN.html#t1">t1</a></span> :: <span class="id"><a href="CDF.FUN.html#t2">t2</a></span> :: <span class="id"><a href="CDF.FUN.html#t3">t3</a></span> :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t3">t3</a></span> := <span class="id"><a href="CDF.FUN.html#Intrinsic.VS">VS</a></span> <span class="id"><a href="CDF.FUN.html#Intrinsic.V2">V2</a></span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">term</span> <span class="id">E</span> <span class="id">t</span></span> est le type des termes ayant le type <span class="bracket"><span class="id">t</span></span> dans le contexte <span class="bracket"><span class="id">E</span></span>. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="Intrinsic.term">term</a></span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#type">type</a></span> -&gt; <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Intrinsic.Var">Var</a></span>: <span class="kwd">forall</span> {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#Intrinsic.var">var</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Intrinsic.Abs">Abs</a></span>: <span class="kwd">forall</span> {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span> <span class="id">t</span>': <span class="id"><a href="CDF.FUN.html#type">type</a></span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#term">term</a></span> (<span class="id"><a href="CDF.FUN.html#t">t</a></span> :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id">t</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> (<span class="id"><a href="CDF.FUN.html#Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> <span class="id">t</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a name="Intrinsic.App">App</a></span>: <span class="kwd">forall</span> {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span> <span class="id">t</span>': <span class="id"><a href="CDF.FUN.html#type">type</a></span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> (<span class="id"><a href="CDF.FUN.html#Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> <span class="id">t</span>') -&gt; <span class="id"><a href="CDF.FUN.html#term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id">t</span>'<br/>
&nbsp;&nbsp;| <span class="id"><a name="Intrinsic.Const">Const</a></span>: <span class="kwd">forall</span> {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} (<span class="id">b</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#Bool">Bool</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Intrinsic.Cond">Cond</a></span>: <span class="kwd">forall</span> {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#Bool">Bool</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span>.<br/>
<br/>
<div class="doc">Exemples de termes. </div>
<br/>
<div class="doc">Le terme <span class="bracket"><span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id">false</span> <span class="kwd">else</span> <span class="id">true</span></span>. </div>
<span class="kwd">Definition</span> <span class="id"><a name="Intrinsic.t_negation">t_negation</a></span> : <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> (<span class="id"><a href="CDF.FUN.html#Bool">Bool</a></span> --&gt; <span class="id"><a href="CDF.FUN.html#Bool">Bool</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#Intrinsic.Abs">Abs</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Cond">Cond</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Var">Var</a></span> <span class="id"><a href="CDF.FUN.html#Intrinsic.V1">V1</a></span>) (<span class="id"><a href="CDF.FUN.html#Intrinsic.Const">Const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) (<span class="id"><a href="CDF.FUN.html#Intrinsic.Const">Const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)).<br/>
<br/>
<div class="doc">Le terme <span class="bracket"><span class="kwd">fun</span> <span class="id">f</span> =&gt; <span class="kwd">fun</span> <span class="id">g</span> =&gt; <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">g</span> (<span class="id">f</span> <span class="id">x</span>)</span>. </div>
<span class="kwd">Definition</span> <span class="id"><a name="Intrinsic.t_compose">t_compose</a></span> (<span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ((<span class="id"><a href="CDF.FUN.html#t1">t1</a></span> --&gt; <span class="id"><a href="CDF.FUN.html#t2">t2</a></span>) --&gt; (<span class="id"><a href="CDF.FUN.html#t2">t2</a></span> --&gt; <span class="id"><a href="CDF.FUN.html#t3">t3</a></span>) --&gt; (<span class="id"><a href="CDF.FUN.html#t1">t1</a></span> --&gt; <span class="id"><a href="CDF.FUN.html#t3">t3</a></span>)) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#Intrinsic.Abs">Abs</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Abs">Abs</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Abs">Abs</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.App">App</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Var">Var</a></span> <span class="id"><a href="CDF.FUN.html#Intrinsic.V2">V2</a></span>) (<span class="id"><a href="CDF.FUN.html#Intrinsic.App">App</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Var">Var</a></span> <span class="id"><a href="CDF.FUN.html#Intrinsic.V3">V3</a></span>) (<span class="id"><a href="CDF.FUN.html#Intrinsic.Var">Var</a></span> <span class="id"><a href="CDF.FUN.html#Intrinsic.V1">V1</a></span>))))).<br/>
<br/>
<div class="doc">Un terme mal typé et donc impossible à exprimer. </div>
<span class="id">Fail</span> <span class="kwd">Definition</span> <span class="id"><a name="Intrinsic.t_error">t_error</a></span> : <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="CDF.FUN.html#Bool">Bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#Intrinsic.Cond">Cond</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Abs">Abs</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Var">Var</a></span> <span class="id"><a href="CDF.FUN.html#Intrinsic.V1">V1</a></span>)) (<span class="id"><a href="CDF.FUN.html#Intrinsic.Const">Const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) (<span class="id"><a href="CDF.FUN.html#Intrinsic.Const">Const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
<br/>
<div class="doc">On interprète une expression de type FUN par un type Coq.
    C'est le type des valeurs Coq qui correspondent à ce type FUN. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="Intrinsic.dtype">dtype</a></span> (<span class="id">t</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>) : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Bool">Bool</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Fun">Fun</a></span> <span class="id">t1</span> <span class="id">t2</span> =&gt; <span class="id"><a href="CDF.FUN.html#dtype">dtype</a></span> <span class="id">t1</span> -&gt; <span class="id"><a href="CDF.FUN.html#dtype">dtype</a></span> <span class="id">t2</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">On interprète de même un contexte de typage par un type Coq.
    C'est le type des environnements d'évaluation qui correspondent
    à ce contexte: une liste hétérogène des valeurs associées aux variables. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="Intrinsic.dcontext">dcontext</a></span> (<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>) : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span><br/>
&nbsp;&nbsp;| <span class="id">t</span> :: <span class="id">E</span> =&gt; <span class="id"><a href="CDF.FUN.html#Intrinsic.dtype">dtype</a></span> <span class="id">t</span> * <span class="id"><a href="CDF.FUN.html#dcontext">dcontext</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">La sémantique dénotationnelle d'une variable.
    C'est la valeur associée à la variable dans l'environnement d'exécution. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="Intrinsic.dvar">dvar</a></span> {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>} (<span class="id">v</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.var">var</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span>): <span class="id"><a href="CDF.FUN.html#Intrinsic.dcontext">dcontext</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#Intrinsic.dtype">dtype</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Intrinsic.V1">V1</a></span> =&gt; (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Intrinsic.VS">VS</a></span> <span class="id">v</span> =&gt; (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="CDF.FUN.html#dvar">dvar</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>))<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">La sémantique dénotationnelle d'un terme.
    C'est une fonction des environnements d'exécution <span class="bracket"><span class="id">dcontext</span> <span class="id">E</span></span>
    dans les valeurs du type de l'expression <span class="bracket"><span class="id">dtype</span> <span class="id">t</span></span>. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="Intrinsic.dterm">dterm</a></span> {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>} (<span class="id">a</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span>) : <span class="id"><a href="CDF.FUN.html#Intrinsic.dcontext">dcontext</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#Intrinsic.dtype">dtype</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Intrinsic.Var">Var</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="CDF.FUN.html#Intrinsic.dvar">dvar</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Intrinsic.Abs">Abs</a></span> <span class="id">a</span> =&gt; (<span class="kwd">fun</span> <span class="id">e</span> =&gt; (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="id"><a href="CDF.FUN.html#dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> (<span class="id"><a href="CDF.FUN.html#v">v</a></span>, <span class="id"><a href="CDF.FUN.html#e">e</a></span>)))<br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Intrinsic.App">App</a></span> <span class="id">a1</span> <span class="id">a2</span> =&gt; (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="CDF.FUN.html#dterm">dterm</a></span> <span class="id">a1</span> <span class="id"><a href="CDF.FUN.html#e">e</a></span> (<span class="id"><a href="CDF.FUN.html#dterm">dterm</a></span> <span class="id">a2</span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>))<br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Intrinsic.Const">Const</a></span> <span class="id">b</span> =&gt; (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id">b</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="CDF.FUN.html#Intrinsic.Cond">Cond</a></span> <span class="id">a</span> <span class="id">ifso</span> <span class="id">ifnot</span> =&gt; (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="CDF.FUN.html#dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span> <span class="kwd">then</span> <span class="id"><a href="CDF.FUN.html#dterm">dterm</a></span> <span class="id">ifso</span> <span class="id"><a href="CDF.FUN.html#e">e</a></span> <span class="kwd">else</span> <span class="id"><a href="CDF.FUN.html#dterm">dterm</a></span> <span class="id">ifnot</span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">La sémantique d'un beta-redex <span class="bracket"><span class="id">App</span> (<span class="id">Abs</span> <span class="id">a</span>) <span class="id">b</span></span> est tout simplement
    celle de la liaison <span class="bracket"><span class="kwd">let</span> 1 = <span class="id">b</span> <span class="kwd">in</span> <span class="id">a</span></span>: on évalue <span class="bracket"><span class="id">a</span></span> après avoir
    lié la variable d'indice 1 à la valeur de <span class="bracket"><span class="id">b</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Intrinsic.dbeta">dbeta</a></span>: <span class="kwd">forall</span> (<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>) (<span class="id">t</span> <span class="id">t</span>': <span class="id"><a href="CDF.FUN.html#type">type</a></span>) (<span class="id">a</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> (<span class="id"><a href="CDF.FUN.html#t">t</a></span> :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id">t</span>') (<span class="id">b</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span>, <span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.App">App</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Abs">Abs</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>) <span class="id"><a href="CDF.FUN.html#b">b</a></span>) <span class="id"><a href="CDF.FUN.html#e">e</a></span> = <span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>, <span class="id"><a href="CDF.FUN.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof160')">Proof.</div>
<div class="proofscript" id="proof160">
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Afin de définir une sémantique opérationnelle à réductions,
    nous construisons maintenant une fonction de substitution.
    La substitution de la variable d'indice 1 par <span class="bracket"><span class="id">b</span></span> dans <span class="bracket"><span class="id">a</span></span> a pour type
<pre>
   subst1 {t': type} {E: context} {t: type} (a: term (t' :: E) t) (b: term E t') : term E t</pre>
    et satisfait l'équation <span class="bracket"><span class="id">dterm</span> (<span class="id">subst1</span> <span class="id">a</span> <span class="id">b</span>) <span class="id">e</span> = <span class="id">dterm</span> <span class="id">a</span> (<span class="id">dterm</span> <span class="id">b</span> <span class="id">e</span>, <span class="id">e</span>)</span>. </div>
<br/>
<div class="doc">La construction de la substitution est difficile, car
<ul>
<li>
   il faut gérer les indices de de Bruijn, d'où le besoin de recalages
    d'indices (fonction <span class="bracket"><span class="id">lift</span></span> ci-dessous);
</li>
<li>
   les fonctions ont des types dépendants complexes, qui d'un côté
    garantissent la préservation du typage par substitution, mais de
    l'autre rendent l'écriture directe des fonctions difficile;
</li>
<li>
   nous avons choisi de prouver des équations sémantiques sur nos fonctions
    en même temps que nous les définissons, d'où de nombreux types
    sous-ensemble <span class="bracket"> { <span class="id">x</span> | <span class="id">P</span> <span class="id">x</span> } </span>.
</li>
</ul>
</div>
<br/>
<div class="doc">Les fonctions de recalage. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="Intrinsic.unlift_env">unlift_env</a></span> (<span class="id">E</span>': <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>) (<span class="id">t</span>': <span class="id"><a href="CDF.FUN.html#type">type</a></span>) (<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>) : <span class="id"><a href="CDF.FUN.html#Intrinsic.dcontext">dcontext</a></span> (<span class="id">E</span>' ++ <span class="id">t</span>' :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) -&gt; <span class="id"><a href="CDF.FUN.html#Intrinsic.dcontext">dcontext</a></span> (<span class="id">E</span>' ++ <span class="id"><a href="CDF.FUN.html#E">E</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">E</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span><br/>
&nbsp;&nbsp;| <span class="id">t</span> :: <span class="id">E</span>' =&gt; <span class="kwd">fun</span> <span class="id">e</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>, <span class="id"><a href="CDF.FUN.html#unlift_env">unlift_env</a></span> <span class="id">E</span>' <span class="id">t</span>' <span class="id"><a href="CDF.FUN.html#E">E</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>))<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Intrinsic.lift_var">lift_var</a></span>  (<span class="id">E</span>': <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>) (<span class="id">t</span>': <span class="id"><a href="CDF.FUN.html#type">type</a></span>) {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>} (<span class="id">v</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.var">var</a></span> (<span class="id">E</span>' ++ <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t">t</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">w</span> : <span class="id"><a href="CDF.FUN.html#Intrinsic.var">var</a></span> (<span class="id">E</span>' ++ <span class="id">t</span>' :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t">t</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">forall</span> <span class="id">e</span>, <span class="id"><a href="CDF.FUN.html#Intrinsic.dvar">dvar</a></span> <span class="id"><a href="CDF.FUN.html#w">w</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span> = <span class="id"><a href="CDF.FUN.html#Intrinsic.dvar">dvar</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.unlift_env">unlift_env</a></span> <span class="id">E</span>' <span class="id">t</span>' <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>)}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof161')">Proof.</div>
<div class="proofscript" id="proof161">
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">E</span>' <span class="id">t</span>' <span class="id">E</span> <span class="id">t</span> <span class="id">v</span>. <span class="tactic">induction</span> <span class="id">E</span>' <span class="kwd">as</span> [ | <span class="id">t0</span> <span class="id">E</span>' ]; <span class="id">cbn</span>.<br/>
- <span class="tactic">intros</span>. <span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.VS">VS</a></span> <span class="id">v</span>). <span class="tactic">auto</span>.<br/>
- <span class="tactic">intros</span>. <span class="tactic">dependent</span> <span class="tactic">destruction</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exists</span> <span class="id"><a href="CDF.FUN.html#Intrinsic.V1">V1</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">IHE</span>' <span class="id">t</span>' <span class="id">_</span> <span class="id">_</span> <span class="id">v</span>) <span class="kwd">as</span> (<span class="id">w</span> &amp; <span class="id">W</span>). <span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.VS">VS</a></span> <span class="id">w</span>). <span class="tactic">intros</span>; <span class="id">cbn</span>. <span class="tactic">rewrite</span> <span class="id">W</span>; <span class="tactic">auto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Intrinsic.lift">lift</a></span> (<span class="id">E</span>': <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>) (<span class="id">t</span>': <span class="id"><a href="CDF.FUN.html#type">type</a></span>) {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>} (<span class="id">a</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> (<span class="id">E</span>' ++ <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t">t</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">b</span> : <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> (<span class="id">E</span>' ++ <span class="id">t</span>' :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t">t</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">forall</span> <span class="id">e</span>, <span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span> = <span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.unlift_env">unlift_env</a></span> <span class="id">E</span>' <span class="id">t</span>' <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>) }.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof162')">Proof.</div>
<div class="proofscript" id="proof162">
&nbsp;&nbsp;<span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">a</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.lift_var">lift_var</a></span> <span class="id">E</span>' <span class="id">t</span>' <span class="id">v</span>) <span class="kwd">as</span> (<span class="id">w</span> &amp; <span class="id">W</span>). <span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Var">Var</a></span> <span class="id">w</span>). <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id">IHa</span> (<span class="id">t</span>::<span class="id">E</span>') <span class="id">_</span> <span class="id">a</span>) <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">B</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Abs">Abs</a></span> <span class="id">b</span>). <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intros</span>. <span class="id">cbn</span>. <span class="tactic">rewrite</span> <span class="id">B</span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id">IHa1</span> <span class="id">E</span>' <span class="id">_</span> <span class="id">a1</span>) <span class="kwd">as</span> (<span class="id">b1</span> &amp; <span class="id">B1</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">IHa2</span> <span class="id">E</span>' <span class="id">_</span> <span class="id">a2</span>) <span class="kwd">as</span> (<span class="id">b2</span> &amp; <span class="id">B2</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.App">App</a></span> <span class="id">b1</span> <span class="id">b2</span>). <span class="id">cbn</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">B1</span>, <span class="id">B2</span>. <span class="tactic">auto</span>.<br/>
- <span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Const">Const</a></span> <span class="id">b</span>); <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id">IHa1</span> <span class="id">E</span>' <span class="id">_</span> <span class="id">a1</span>) <span class="kwd">as</span> (<span class="id">b1</span> &amp; <span class="id">B1</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">IHa2</span> <span class="id">E</span>' <span class="id">_</span> <span class="id">a2</span>) <span class="kwd">as</span> (<span class="id">b2</span> &amp; <span class="id">B2</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">IHa3</span> <span class="id">E</span>' <span class="id">_</span> <span class="id">a3</span>) <span class="kwd">as</span> (<span class="id">b3</span> &amp; <span class="id">B3</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Cond">Cond</a></span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">b3</span>). <span class="tactic">intros</span>; <span class="id">cbn</span>. <span class="tactic">rewrite</span> <span class="id">B1</span>, <span class="id">B2</span>, <span class="id">B3</span>; <span class="tactic">auto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Intrinsic.lift1">lift1</a></span> (<span class="id">t</span>': <span class="id"><a href="CDF.FUN.html#type">type</a></span>) {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>} (<span class="id">a</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">b</span> : <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> (<span class="id">t</span>' :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t">t</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">forall</span> <span class="id">e</span>, <span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span> = <span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>) }.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof163')">Proof.</div>
<div class="proofscript" id="proof163">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#Intrinsic.lift">lift</a></span> <span class="kwd">with</span> (<span class="id">E</span>' := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
Defined.</div>
<br/>
<div class="doc">Les fonctions de substitution. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="Intrinsic.proj_env">proj_env</a></span> (<span class="id">E</span>': <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>) (<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>) : <span class="id"><a href="CDF.FUN.html#Intrinsic.dcontext">dcontext</a></span> (<span class="id">E</span>' ++ <span class="id"><a href="CDF.FUN.html#E">E</a></span>) -&gt; <span class="id"><a href="CDF.FUN.html#Intrinsic.dcontext">dcontext</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">E</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="CDF.FUN.html#e">e</a></span><br/>
&nbsp;&nbsp;| <span class="id">t</span> :: <span class="id">E</span>' =&gt; <span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="CDF.FUN.html#proj_env">proj_env</a></span> <span class="id">E</span>' <span class="id"><a href="CDF.FUN.html#E">E</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="Intrinsic.unsubst_env">unsubst_env</a></span> (<span class="id">E</span>': <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>) (<span class="id">t</span>': <span class="id"><a href="CDF.FUN.html#type">type</a></span>) (<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>) : <span class="id"><a href="CDF.FUN.html#Intrinsic.dcontext">dcontext</a></span> (<span class="id">E</span>' ++  <span class="id"><a href="CDF.FUN.html#E">E</a></span>) -&gt; <span class="id"><a href="CDF.FUN.html#Intrinsic.dtype">dtype</a></span> <span class="id">t</span>' -&gt; <span class="id"><a href="CDF.FUN.html#Intrinsic.dcontext">dcontext</a></span> (<span class="id">E</span>' ++ <span class="id">t</span>' :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">E</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="kwd">fun</span> <span class="id">e</span> <span class="id">v</span> =&gt; (<span class="id"><a href="CDF.FUN.html#v">v</a></span>, <span class="id"><a href="CDF.FUN.html#e">e</a></span>)<br/>
&nbsp;&nbsp;| <span class="id">t</span> :: <span class="id">E</span>' =&gt; <span class="kwd">fun</span> <span class="id">e</span> <span class="id">v</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>, <span class="id"><a href="CDF.FUN.html#unsubst_env">unsubst_env</a></span> <span class="id">E</span>' <span class="id">t</span>' <span class="id"><a href="CDF.FUN.html#E">E</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>) <span class="id"><a href="CDF.FUN.html#v">v</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Intrinsic.subst_var">subst_var</a></span> (<span class="id">E</span>': <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>) (<span class="id">t</span>': <span class="id"><a href="CDF.FUN.html#type">type</a></span>) {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>} (<span class="id">v</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.var">var</a></span> (<span class="id">E</span>' ++ <span class="id">t</span>' :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t">t</a></span>) (<span class="id">b</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id">t</span>') :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">c</span> : <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> (<span class="id">E</span>' ++ <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t">t</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">forall</span> <span class="id">e</span>, <span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#c">c</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span> = <span class="id"><a href="CDF.FUN.html#Intrinsic.dvar">dvar</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.unsubst_env">unsubst_env</a></span> <span class="id">E</span>' <span class="id">t</span>' <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.proj_env">proj_env</a></span> <span class="id">E</span>' <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>))) }.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof164')">Proof.</div>
<div class="proofscript" id="proof164">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">E</span>' <span class="kwd">as</span> [ | <span class="id">t0</span> <span class="id">E</span>' ]; <span class="tactic">simpl</span>.<br/>
- <span class="tactic">dependent</span> <span class="tactic">destruction</span> <span class="id">v</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exists</span> <span class="id">b</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Var">Var</a></span> <span class="id">v</span>); <span class="tactic">auto</span>.<br/>
- <span class="tactic">dependent</span> <span class="tactic">destruction</span> <span class="id">v</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Var">Var</a></span> <span class="id"><a href="CDF.FUN.html#Intrinsic.V1">V1</a></span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">IHE</span>' <span class="id">v</span>) <span class="kwd">as</span> (<span class="id">c</span> &amp; <span class="id">C</span>). <span class="tactic">destruct</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.lift1">lift1</a></span> <span class="id">t0</span> <span class="id">c</span>) <span class="kwd">as</span> (<span class="id">c</span>' &amp; <span class="id">C</span>'). <span class="id">exists</span> <span class="id">c</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">C</span>', <span class="id">C</span>. <span class="tactic">auto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Definition</span> <span class="tactic">subst</span> (<span class="id">E</span>': <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>) (<span class="id">t</span>': <span class="id"><a href="CDF.FUN.html#type">type</a></span>) {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>} (<span class="id">a</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> (<span class="id">E</span>' ++ <span class="id">t</span>' :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t">t</a></span>) (<span class="id">b</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id">t</span>') :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">c</span> : <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> (<span class="id">E</span>' ++ <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t">t</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">forall</span> <span class="id">e</span>, <span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#c">c</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span> = <span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.unsubst_env">unsubst_env</a></span> <span class="id">E</span>' <span class="id">t</span>' <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.proj_env">proj_env</a></span> <span class="id">E</span>' <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>))) }.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof165')">Proof.</div>
<div class="proofscript" id="proof165">
&nbsp;&nbsp;<span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">a</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="CDF.FUN.html#Intrinsic.subst_var">subst_var</a></span>. <br/>
- <span class="id">edestruct</span> (<span class="id">IHa</span> (<span class="id">t</span> :: <span class="id">E</span>') <span class="id">t</span>' <span class="id">E</span> <span class="id">a</span>) <span class="kwd">as</span> (<span class="id">c</span> &amp; <span class="id">C</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Abs">Abs</a></span> <span class="id">c</span>). <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>. <span class="tactic">intros</span> <span class="id">v</span>; <span class="tactic">simpl</span>. <br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">C</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
- <span class="id">edestruct</span> (<span class="id">IHa1</span> <span class="id">E</span>' <span class="id">t</span>' <span class="id">E</span> <span class="id">a1</span>) <span class="kwd">as</span> (<span class="id">c1</span> &amp; <span class="id">C1</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id">IHa2</span> <span class="id">E</span>' <span class="id">t</span>' <span class="id">E</span> <span class="id">a2</span>) <span class="kwd">as</span> (<span class="id">c2</span> &amp; <span class="id">C2</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.App">App</a></span> <span class="id">c1</span> <span class="id">c2</span>). <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">C1</span>, <span class="id">C2</span>. <span class="tactic">eauto</span>.<br/>
- <span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Const">Const</a></span> <span class="id">b</span>). <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
- <span class="id">edestruct</span> (<span class="id">IHa1</span> <span class="id">E</span>' <span class="id">t</span>' <span class="id">E</span> <span class="id">a1</span>) <span class="kwd">as</span> (<span class="id">c1</span> &amp; <span class="id">C1</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id">IHa2</span> <span class="id">E</span>' <span class="id">t</span>' <span class="id">E</span> <span class="id">a2</span>) <span class="kwd">as</span> (<span class="id">c2</span> &amp; <span class="id">C2</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id">IHa3</span> <span class="id">E</span>' <span class="id">t</span>' <span class="id">E</span> <span class="id">a3</span>) <span class="kwd">as</span> (<span class="id">c3</span> &amp; <span class="id">C3</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Cond">Cond</a></span> <span class="id">c1</span> <span class="id">c2</span> <span class="id">c3</span>). <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">C1</span>, <span class="id">C2</span>, <span class="id">C3</span>. <span class="tactic">eauto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Intrinsic.subst1">subst1</a></span> {<span class="id">t</span>': <span class="id"><a href="CDF.FUN.html#type">type</a></span>} {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>} (<span class="id">a</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> (<span class="id">t</span>' :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t">t</a></span>) (<span class="id">b</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id">t</span>') : <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> (<span class="tactic">subst</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">t</span>' <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Intrinsic.dterm_subst1">dterm_subst1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">t</span>': <span class="id"><a href="CDF.FUN.html#type">type</a></span>} {<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>} {<span class="id">t</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>} (<span class="id">a</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> (<span class="id">t</span>' :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t">t</a></span>) (<span class="id">b</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id">t</span>') <span class="id">e</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.subst1">subst1</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span>) <span class="id"><a href="CDF.FUN.html#e">e</a></span> = <span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>, <span class="id"><a href="CDF.FUN.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof166')">Proof.</div>
<div class="proofscript" id="proof166">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="CDF.FUN.html#Intrinsic.subst1">subst1</a></span>. <span class="tactic">destruct</span> (<span class="tactic">subst</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">t</span>' <span class="id">a</span> <span class="id">b</span>) <span class="kwd">as</span> (<span class="id">c</span> &amp; <span class="id">C</span>). <span class="tactic">apply</span> <span class="id">C</span>. <br/>
Qed.</div>
<br/>
<div class="doc">La sémantique à réductions. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="Intrinsic.isvalue">isvalue</a></span>: <span class="kwd">forall</span> (<span class="id">E</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.context">context</a></span>) (<span class="id">t</span>: <span class="id"><a href="CDF.FUN.html#type">type</a></span>), <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Intrinsic.V_Abs">V_Abs</a></span>: <span class="kwd">forall</span> <span class="id">E</span> <span class="id">t1</span> <span class="id">t2</span> (<span class="id">a</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> (<span class="id"><a href="CDF.FUN.html#t1">t1</a></span> :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t2">t2</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> (<span class="id"><a href="CDF.FUN.html#Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#t1">t1</a></span> <span class="id"><a href="CDF.FUN.html#t2">t2</a></span>) (<span class="id"><a href="CDF.FUN.html#Intrinsic.Abs">Abs</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="Intrinsic.V_Const">V_Const</a></span>: <span class="kwd">forall</span> <span class="id">E</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#isvalue">isvalue</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#Bool">Bool</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Const">Const</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span>).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="tactic">red</span>: <span class="kwd">forall</span> <span class="id">E</span> <span class="id">t</span>, <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Intrinsic.red_beta">red_beta</a></span>: <span class="kwd">forall</span> <span class="id">E</span> <span class="id">t1</span> <span class="id">t2</span> (<span class="id">a</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> (<span class="id"><a href="CDF.FUN.html#t1">t1</a></span> :: <span class="id"><a href="CDF.FUN.html#E">E</a></span>) <span class="id"><a href="CDF.FUN.html#t2">t2</a></span>) (<span class="id">v</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t1">t1</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#Intrinsic.isvalue">isvalue</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t1">t1</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t2">t2</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.App">App</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Abs">Abs</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span>) <span class="id"><a href="CDF.FUN.html#v">v</a></span>) (<span class="id"><a href="CDF.FUN.html#Intrinsic.subst1">subst1</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="Intrinsic.red_cond">red_cond</a></span>: <span class="kwd">forall</span> <span class="id">E</span> <span class="id">t</span> (<span class="id">b</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">ifso</span> <span class="id">ifnot</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Cond">Cond</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Const">Const</a></span> <span class="id"><a href="CDF.FUN.html#b">b</a></span>) <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span>) (<span class="kwd">if</span> <span class="id"><a href="CDF.FUN.html#b">b</a></span> <span class="kwd">then</span> <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="kwd">else</span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="Intrinsic.red_app_1">red_app_1</a></span>: <span class="kwd">forall</span> <span class="id">E</span> <span class="id">t</span> <span class="id">t</span>' (<span class="id">a1</span> <span class="id">a1</span>': <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> (<span class="id"><a href="CDF.FUN.html#Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> <span class="id">t</span>')) (<span class="id">a2</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> (<span class="id"><a href="CDF.FUN.html#Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> <span class="id">t</span>') <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> <span class="id">a1</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id">t</span>' (<span class="id"><a href="CDF.FUN.html#Intrinsic.App">App</a></span> <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span>) (<span class="id"><a href="CDF.FUN.html#Intrinsic.App">App</a></span> <span class="id">a1</span>' <span class="id"><a href="CDF.FUN.html#a2">a2</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="Intrinsic.red_app_2">red_app_2</a></span>: <span class="kwd">forall</span> <span class="id">E</span> <span class="id">t</span> <span class="id">t</span>' (<span class="id">v</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> (<span class="id"><a href="CDF.FUN.html#Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> <span class="id">t</span>')) (<span class="id">a2</span> <span class="id">a2</span>': <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.FUN.html#Intrinsic.isvalue">isvalue</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> (<span class="id"><a href="CDF.FUN.html#Fun">Fun</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> <span class="id">t</span>') <span class="id"><a href="CDF.FUN.html#v">v</a></span> -&gt; <span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span> <span class="id">a2</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id">t</span>' (<span class="id"><a href="CDF.FUN.html#Intrinsic.App">App</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span>) (<span class="id"><a href="CDF.FUN.html#Intrinsic.App">App</a></span> <span class="id"><a href="CDF.FUN.html#v">v</a></span> <span class="id">a2</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a name="Intrinsic.red_cond_1">red_cond_1</a></span>: <span class="kwd">forall</span> <span class="id">E</span> <span class="id">t</span> (<span class="id">a</span> <span class="id">a</span>': <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#Bool">Bool</a></span>) (<span class="id">ifso</span> <span class="id">ifnot</span>: <span class="id"><a href="CDF.FUN.html#Intrinsic.term">term</a></span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#Bool">Bool</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id">a</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> (<span class="id"><a href="CDF.FUN.html#Intrinsic.Cond">Cond</a></span> <span class="id"><a href="CDF.FUN.html#a">a</a></span> <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span>) (<span class="id"><a href="CDF.FUN.html#Intrinsic.Cond">Cond</a></span> <span class="id">a</span>' <span class="id"><a href="CDF.FUN.html#ifso">ifso</a></span> <span class="id"><a href="CDF.FUN.html#ifnot">ifnot</a></span>).<br/>
<br/>
<div class="doc">Compatibilité entre réductions et sémantique dénotationnelle. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Intrinsic.red_denot">red_denot</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">E</span> <span class="id">t</span> <span class="id">a1</span> <span class="id">a2</span>, <span class="tactic">red</span> <span class="id"><a href="CDF.FUN.html#E">E</a></span> <span class="id"><a href="CDF.FUN.html#t">t</a></span> <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span> -&gt; <span class="kwd">forall</span> <span class="id">e</span>, <span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#a1">a1</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span> = <span class="id"><a href="CDF.FUN.html#Intrinsic.dterm">dterm</a></span> <span class="id"><a href="CDF.FUN.html#a2">a2</a></span> <span class="id"><a href="CDF.FUN.html#e">e</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof167')">Proof.</div>
<div class="proofscript" id="proof167">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="CDF.FUN.html#Intrinsic.dterm_subst1">dterm_subst1</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">IHred</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">IHred</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">IHred</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CDF.FUN.html#Intrinsic">Intrinsic</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
