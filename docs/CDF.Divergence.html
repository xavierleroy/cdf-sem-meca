
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Divergence</title>
<meta name="description" content="Documentation of Coq module Divergence" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Divergence</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Arith.html">Arith</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.ZArith.html">ZArith</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.micromega.Psatz.html">Psatz</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html">Bool</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Strings.String.html">String</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">From</span> <span class="id">CDF</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CDF.Sequences.html">Sequences</a></span> <span class="id"><a href="CDF.IMP.html">IMP</a></span> <span class="id"><a href="CDF.Compil.html">Compil</a></span>.<br/>
<br/>
<h1> 6.  Sémantiques de la divergence, première partie </h1>
<br/>
<div class="doc">Certaines démonstrations de ce fichier ne sont pas constructives
    et utilisent des axiomes de logique classique, à savoir: l'axiome
    du tiers exclu et un axiome de description.  Ces axiomes sont
    importés depuis la bibliothèque standard de Coq. </div>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Classical.html">Classical</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Description.html">Description</a></span>.<br/>
<br/>
<span class="kwd">Check</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
<span class="kwd">Check</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Description.html#constructive_definite_description">constructive_definite_description</a></span>.<br/>
<br/>
<h2> 6.1.  L'interpréteur borné </h2>
<br/>
<div class="doc">Nous reprenons l'interpréteur de référence <span class="bracket"><span class="id">cexec_f</span></span> du fichier <span class="bracket"><span class="id">IMP</span></span>,
    en le réécrivant dans un style plus monadique.  La terminaison
    de l'interpréteur est garantie par le paramètre de "fuel"
    qui décroît à chaque appel récursif.   S'il tombe à zéro,
    l'exécution renvoie <span class="bracket"><span class="id">None</span></span>, ce qui signifie que l'état final à la fin
    de l'exécution de la commande n'a pas pu être calculé: soit la commande
    diverge, soit il faut davantage de "fuel" pour l'exécuter entièrement. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="bind">bind</a></span> {<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Type</span>} (<span class="id">m</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">B</span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">B</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">m</span> <span class="kwd">with</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> | <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">s</span> =&gt; <span class="id">f</span> <span class="id">s</span> <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="cinterp">cinterp</a></span> (<span class="id">fuel</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">c</span>: <span class="id"><a href="CDF.IMP.html#com">com</a></span>) (<span class="id">s</span>: <span class="id"><a href="CDF.IMP.html#store">store</a></span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CDF.IMP.html#store">store</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">fuel</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">c</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CDF.IMP.html#SKIP">SKIP</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CDF.IMP.html#ASSIGN">ASSIGN</a></span> <span class="id">x</span> <span class="id">a</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="CDF.IMP.html#update">update</a></span> <span class="id">x</span> (<span class="id"><a href="CDF.IMP.html#aeval">aeval</a></span> <span class="id">a</span> <span class="id">s</span>) <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CDF.IMP.html#SEQ">SEQ</a></span> <span class="id">c1</span> <span class="id">c2</span> =&gt; <span class="id"><a href="CDF.Divergence.html#bind">bind</a></span> (<span class="id">cinterp</span> <span class="id">n</span> <span class="id">c1</span> <span class="id">s</span>) (<span class="id">cinterp</span> <span class="id">n</span> <span class="id">c2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CDF.IMP.html#IFTHENELSE">IFTHENELSE</a></span> <span class="id">b</span> <span class="id">c1</span> <span class="id">c2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cinterp</span> <span class="id">n</span> (<span class="kwd">if</span> <span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span> <span class="kwd">then</span> <span class="id">c1</span> <span class="kwd">else</span> <span class="id">c2</span>) <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id">b</span> <span class="id">c1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="CDF.Divergence.html#bind">bind</a></span> (<span class="id">cinterp</span> <span class="id">n</span> <span class="id">c1</span> <span class="id">s</span>) (<span class="id">cinterp</span> <span class="id">n</span> (<span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id">b</span> <span class="id">c1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Une propriété cruciale de cet interpréteur borné est que la fonction
    <span class="bracket"><span class="id">cinterp</span></span> est croissante: davantage de "fuel" donne un résultat mieux
    défini, d'après l'ordre <span class="bracket">&lt;&lt;=</span> ci-dessous. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="lessdef">lessdef</a></span> {<span class="id">A</span>: <span class="kwd">Type</span>}: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="lessdef_none">lessdef_none</a></span>: <span class="kwd">forall</span> <span class="id">oa</span>, <span class="id">lessdef</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">oa</span><br/>
&nbsp;&nbsp;| <span class="id"><a name="lessdef_some">lessdef_some</a></span>: <span class="kwd">forall</span> <span class="id">a</span>, <span class="id">lessdef</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">a</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">a</span>).<br/>
<br/>
<span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id"><a href="CDF.Divergence.html#lessdef">lessdef</a></span>.<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">x</span> &lt;&lt;= <span class="id">y</span>" := (<span class="id"><a href="CDF.Divergence.html#lessdef">lessdef</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="kwd">at</span> <span class="id">level</span> 70, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="lessdef_refl">lessdef_refl</a></span>: <span class="kwd">forall</span> (<span class="id">A</span>: <span class="kwd">Type</span>) (<span class="id">x</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>), <span class="id">x</span> &lt;&lt;= <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="bind_mono">bind_mono</a></span>: <span class="kwd">forall</span> (<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Type</span>) (<span class="id">x</span> <span class="id">x</span>': <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) (<span class="id">f</span> <span class="id">f</span>': <span class="id">A</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">B</span>),<br/>
&nbsp;&nbsp;<span class="id">x</span> &lt;&lt;= <span class="id">x</span>' -&gt; (<span class="kwd">forall</span> <span class="id">v</span>, <span class="id">f</span> <span class="id">v</span> &lt;&lt;= <span class="id">f</span>' <span class="id">v</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Divergence.html#bind">bind</a></span> <span class="id">x</span> <span class="id">f</span> &lt;&lt;= <span class="id"><a href="CDF.Divergence.html#bind">bind</a></span> <span class="id">x</span>' <span class="id">f</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">H</span>; <span class="id">cbn</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cinterp_mono">cinterp_mono</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">j</span> <span class="id">c</span> <span class="id">s</span>, <span class="id">i</span> &lt;= <span class="id">j</span> -&gt; <span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">i</span> <span class="id">c</span> <span class="id">s</span> &lt;&lt;= <span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">i</span> <span class="kwd">as</span> [ | <span class="id">i</span>]; <span class="id">intros</span>; <span class="id">cbn</span>.<br/>
- <span class="id">auto</span>.<br/>
- <span class="id">destruct</span> <span class="id">j</span> <span class="kwd">as</span> [ | <span class="id">j</span>]. <span class="id">lia</span>. <span class="id">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#bind_mono">bind_mono</a></span>. <span class="id">apply</span> <span class="id">IHi</span>; <span class="id">lia</span>. <span class="id">intros</span>; <span class="id">apply</span> <span class="id">IHi</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">IHi</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;+ <span class="id">destruct</span> (<span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#bind_mono">bind_mono</a></span>. <span class="id">apply</span> <span class="id">IHi</span>; <span class="id">lia</span>. <span class="id">intros</span>; <span class="id">apply</span> <span class="id">IHi</span>; <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<h2> 6.2.  De l'interpréteur borné à une sémantique dénotationnelle </h2>
<br/>
<div class="doc">Toute suite <span class="bracket"><span class="id">nat</span> -&gt; <span class="id">option</span> <span class="id">A</span></span> qui est croissante pour l'ordre <span class="bracket">&lt;&lt;=</span>
    est stationnaire à partir d'un certain indice.  La valeur à laquelle
    elle stationne est la limite de cette suite. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="LIMIT">LIMIT</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">A</span>: <span class="kwd">Type</span>} (<span class="id">f</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="LIMIT.f_mono">f_mono</a></span>: <span class="kwd">forall</span> <span class="id">i</span> <span class="id">j</span>, <span class="id">i</span> &lt;= <span class="id">j</span> -&gt; <span class="id"><a href="CDF.Divergence.html#LIMIT.f">f</a></span> <span class="id">i</span> &lt;&lt;= <span class="id"><a href="CDF.Divergence.html#LIMIT.f">f</a></span> <span class="id">j</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="limit_exists">limit_exists</a></span>:<br/>
&nbsp;&nbsp;{ <span class="id">lim</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CDF.Divergence.html#LIMIT.A">A</a></span> | <span class="kwd">exists</span> <span class="id">i</span>, <span class="kwd">forall</span> <span class="id">j</span>, <span class="id">i</span> &lt;= <span class="id">j</span> -&gt; <span class="id"><a href="CDF.Divergence.html#LIMIT.f">f</a></span> <span class="id">j</span> = <span class="id">lim</span> }.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Description.html#constructive_definite_description">constructive_definite_description</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span> (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="CDF.Divergence.html#LIMIT.f">f</a></span> <span class="id">i</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)) <span class="kwd">as</span> [<span class="id">DIV</span>|<span class="id">TERM</span>].<br/>
- <span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;+ <span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">lim</span> (<span class="id">i</span> &amp; <span class="id">LIM</span>). <span class="id">rewrite</span> &lt;- (<span class="id">DIV</span> <span class="id">i</span>). <span class="id">apply</span> <span class="id">LIM</span>; <span class="id">lia</span>.<br/>
- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="kwd">in</span> <span class="id">TERM</span>. <span class="id">destruct</span> <span class="id">TERM</span> <span class="kwd">as</span> (<span class="id">i</span> &amp; <span class="id">TERM</span>).<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="CDF.Divergence.html#LIMIT.f">f</a></span> <span class="id">i</span>); <span class="id">split</span>.<br/>
&nbsp;&nbsp;+ <span class="kwd">exists</span> <span class="id">i</span>; <span class="id">intros</span>. <span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#LIMIT.f_mono">f_mono</a></span> <span class="id">i</span> <span class="id">j</span> <span class="id">H</span>). <span class="id">congruence</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">lim</span> (<span class="id">i2</span> &amp; <span class="id">LIM2</span>). <span class="id">set</span> (<span class="id">j</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.max">Nat.max</a></span> <span class="id">i</span> <span class="id">i2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id">LIM2</span> <span class="id">j</span>) <span class="kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#LIMIT.f_mono">f_mono</a></span> <span class="id">i</span> <span class="id">j</span>). <span class="id">lia</span>. <span class="id">congruence</span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="limit">limit</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CDF.Divergence.html#LIMIT.A">A</a></span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id"><a href="CDF.Divergence.html#limit_exists">limit_exists</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="limit_charact">limit_charact</a></span>: <span class="kwd">exists</span> <span class="id">i</span>, <span class="kwd">forall</span> <span class="id">j</span>, <span class="id">i</span> &lt;= <span class="id">j</span> -&gt; <span class="id"><a href="CDF.Divergence.html#LIMIT.f">f</a></span> <span class="id">j</span> = <span class="id"><a href="CDF.Divergence.html#limit">limit</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="CDF.Divergence.html#limit">limit</a></span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj2_sig">proj2_sig</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CDF.Divergence.html#LIMIT">LIMIT</a></span>.<br/>
<br/>
<div class="doc">On définit la dénotation d'une commande <span class="bracket"><span class="id">c</span></span> dans l'état initial <span class="bracket"><span class="id">s</span></span>
    comme la limite de l'interprétation de <span class="bracket"><span class="id">c</span></span> quand le fuel tend vers
    l'infini. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="denot">denot</a></span> (<span class="id">c</span>: <span class="id"><a href="CDF.IMP.html#com">com</a></span>) (<span class="id">s</span>: <span class="id"><a href="CDF.IMP.html#store">store</a></span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CDF.IMP.html#store">store</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Divergence.html#limit">limit</a></span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">n</span> <span class="id">c</span> <span class="id">s</span>) (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id"><a href="CDF.Divergence.html#cinterp_mono">cinterp_mono</a></span> <span class="id">i</span> <span class="id">j</span> <span class="id">c</span> <span class="id">s</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="denot_charact">denot_charact</a></span>: <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">s</span>, <span class="kwd">exists</span> <span class="id">i</span>, <span class="kwd">forall</span> <span class="id">j</span>, <span class="id">i</span> &lt;= <span class="id">j</span> -&gt; <span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">s</span> = <span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id">c</span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#limit_charact">limit_charact</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="denot_unique">denot_unique</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">s</span> <span class="id">i</span> <span class="id">lim</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">j</span>, <span class="id">i</span> &lt;= <span class="id">j</span> -&gt; <span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">s</span> = <span class="id">lim</span>) -&gt; <span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id">c</span> <span class="id">s</span> = <span class="id">lim</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#denot_charact">denot_charact</a></span> <span class="id">c</span> <span class="id">s</span>) <span class="kwd">as</span> (<span class="id">i</span>' &amp; <span class="id">LIM</span>').<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">j</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.max">Nat.max</a></span> <span class="id">i</span> <span class="id">i</span>').<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id">H</span> <span class="id">j</span>), &lt;- (<span class="id">LIM</span>' <span class="id">j</span>) <span class="kwd">by</span> <span class="id">lia</span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="denot_some">denot_some</a></span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">c</span> <span class="id">s</span> <span class="id">s</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">n</span> <span class="id">c</span> <span class="id">s</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">s</span>' -&gt; <span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id">c</span> <span class="id">s</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">s</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#denot_unique">denot_unique</a></span> <span class="kwd">with</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#cinterp_mono">cinterp_mono</a></span> <span class="id">n</span> <span class="id">j</span> <span class="id">c</span> <span class="id">s</span> <span class="id">H0</span>); <span class="id">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="denot_none">denot_none</a></span>: <span class="kwd">forall</span> <span class="id">c</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">n</span> <span class="id">c</span> <span class="id">s</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) &lt;-&gt; <span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id">c</span> <span class="id">s</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">split</span>; <span class="id">intros</span>.<br/>
- <span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#denot_unique">denot_unique</a></span> <span class="kwd">with</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>. <span class="id">auto</span>.<br/>
- <span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">n</span> <span class="id">c</span> <span class="id">s</span>) <span class="kwd">as</span> [<span class="id">s</span>'|] <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#denot_some">denot_some</a></span> <span class="kwd">in</span> <span class="id">C</span>. <span class="id">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="denot_eq">denot_eq</a></span>: <span class="kwd">forall</span> <span class="id">c</span> <span class="id">s</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">n</span> <span class="id">c</span> <span class="id">s</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> \/ <span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">n</span> <span class="id">c</span> <span class="id">s</span> = <span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id">c</span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">n</span> <span class="id">c</span> <span class="id">s</span>) <span class="kwd">as</span> [<span class="id">s</span>'|] <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="id">symmetry</span>; <span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#denot_some">denot_some</a></span> <span class="kwd">with</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Cette définition de <span class="bracket"><span class="id">denot</span></span> satisfait les équations attendues pour
    une sémantique dénotationnelle du langage IMP. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="denot_skip">denot_skip</a></span>: <span class="kwd">forall</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id"><a href="CDF.IMP.html#SKIP">SKIP</a></span> <span class="id">s</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#denot_some">denot_some</a></span> <span class="kwd">with</span> 1. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="denot_assign">denot_assign</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">a</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> (<span class="id"><a href="CDF.IMP.html#ASSIGN">ASSIGN</a></span> <span class="id">x</span> <span class="id">a</span>) <span class="id">s</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="CDF.IMP.html#update">update</a></span> <span class="id">x</span> (<span class="id"><a href="CDF.IMP.html#aeval">aeval</a></span> <span class="id">a</span> <span class="id">s</span>) <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#denot_some">denot_some</a></span> <span class="kwd">with</span> 1. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="denot_seq">denot_seq</a></span>: <span class="kwd">forall</span> <span class="id">c1</span> <span class="id">c2</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> (<span class="id"><a href="CDF.IMP.html#SEQ">SEQ</a></span> <span class="id">c1</span> <span class="id">c2</span>) <span class="id">s</span> = <span class="id"><a href="CDF.Divergence.html#bind">bind</a></span> (<span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id">c1</span> <span class="id">s</span>) (<span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id">c2</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="CDF.Divergence.html#bind">bind</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#denot_charact">denot_charact</a></span> <span class="id">c1</span> <span class="id">s</span>) <span class="kwd">as</span>  (<span class="id">i1</span> &amp; <span class="id">LIM1</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id">c1</span> <span class="id">s</span>) <span class="kwd">as</span> [<span class="id">s1</span>|] <span class="id">eqn</span>:<span class="id">D1</span>.<br/>
- <span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#denot_charact">denot_charact</a></span> <span class="id">c2</span> <span class="id">s1</span>) <span class="kwd">as</span>  (<span class="id">i2</span> &amp; <span class="id">LIM2</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#denot_unique">denot_unique</a></span> <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.max">Nat.max</a></span> <span class="id">i1</span> <span class="id">i2</span>)); <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">j</span> <span class="kwd">as</span> [ | <span class="id">j</span>]. <span class="id">lia</span>. <span class="id">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="CDF.Divergence.html#bind">bind</a></span>. <span class="id">rewrite</span> <span class="id">LIM1</span>, <span class="id">LIM2</span> <span class="kwd">by</span> <span class="id">lia</span>. <span class="id">auto</span>.<br/>
- <span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#denot_none">denot_none</a></span>. <span class="id">intros</span>. <span class="id">destruct</span> <span class="id">n</span>; <span class="id">cbn</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#denot_eq">denot_eq</a></span> <span class="id">c1</span> <span class="id">s</span> <span class="id">n</span>) <span class="kwd">as</span> [<span class="id">E</span>|<span class="id">E</span>]; <span class="id">rewrite</span> <span class="id">E</span>, ?<span class="id">D1</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="denot_ifthenelse">denot_ifthenelse</a></span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">c1</span> <span class="id">c2</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> (<span class="id"><a href="CDF.IMP.html#IFTHENELSE">IFTHENELSE</a></span> <span class="id">b</span> <span class="id">c1</span> <span class="id">c2</span>) <span class="id">s</span> = <span class="kwd">if</span> <span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span> <span class="kwd">then</span> <span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id">c1</span> <span class="id">s</span> <span class="kwd">else</span> <span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id">c2</span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;<span class="id">intros</span>. <br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">c</span> := <span class="kwd">if</span> <span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span> <span class="kwd">then</span> <span class="id">c1</span> <span class="kwd">else</span> <span class="id">c2</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#denot_charact">denot_charact</a></span> <span class="id">c</span> <span class="id">s</span>) <span class="kwd">as</span> (<span class="id">i</span> &amp; <span class="id">LIM</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#denot_unique">denot_unique</a></span> <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">i</span>). <span class="id">intros</span>. <span class="id">destruct</span> <span class="id">j</span> <span class="kwd">as</span> [ | <span class="id">j</span>]. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">cbn</span>. <span class="id">rewrite</span> <span class="id">LIM</span> <span class="kwd">by</span> <span class="id">lia</span>. <span class="id">unfold</span> <span class="id">c</span>; <span class="id">destruct</span> (<span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span>); <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="denot_while">denot_while</a></span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">c</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> (<span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id">b</span> <span class="id">c</span>) <span class="id">s</span> =<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span> <span class="kwd">then</span> <span class="id"><a href="CDF.Divergence.html#bind">bind</a></span> (<span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id">c</span> <span class="id">s</span>) (<span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> (<span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id">b</span> <span class="id">c</span>)) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> &lt;- <span class="id"><a href="CDF.Divergence.html#denot_seq">denot_seq</a></span>. <span class="id">set</span> (<span class="id">c</span>' := <span class="id">c</span> ;; <span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id">b</span> <span class="id">c</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#denot_charact">denot_charact</a></span> <span class="id">c</span>' <span class="id">s</span>) <span class="kwd">as</span> (<span class="id">i</span> &amp; <span class="id">LIM</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#denot_unique">denot_unique</a></span> <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">i</span>). <span class="id">intros</span>. <span class="id">destruct</span> <span class="id">j</span> <span class="kwd">as</span> [ | <span class="id">j</span>]. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">cbn</span>. <span class="id">destruct</span> (<span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span>). <span class="id">apply</span> (<span class="id">LIM</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">j</span>)). <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">De plus, la dénotation d'une boucle est la plus petite fonction
    <span class="bracket"><span class="id">F</span>: <span class="id">store</span> -&gt; <span class="id">option</span> <span class="id">store</span></span> qui satisfait l'équation ci-dessus. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="denot_while_min">denot_while_min</a></span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">c</span> <span class="id">F</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">s</span>, <span class="id">F</span> <span class="id">s</span> = <span class="kwd">if</span> <span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span> <span class="kwd">then</span> <span class="id"><a href="CDF.Divergence.html#bind">bind</a></span> (<span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id">c</span> <span class="id">s</span>) <span class="id">F</span> <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">s</span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> (<span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id">b</span> <span class="id">c</span>) <span class="id">s</span> &lt;&lt;= <span class="id">F</span> <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">b</span> <span class="id">c</span> <span class="id">F</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">REC</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">s</span>, <span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">n</span> (<span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id">b</span> <span class="id">c</span>) <span class="id">s</span> &lt;&lt;= <span class="id">F</span> <span class="id">s</span>).<br/>
&nbsp;&nbsp;{ <span class="id">induction</span> <span class="id">n</span> <span class="kwd">as</span> [ | <span class="id">n</span>]; <span class="id">intros</span>; <span class="id">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">EQ</span>. <span class="id">destruct</span> (<span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#bind_mono">bind_mono</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#denot_eq">denot_eq</a></span> <span class="id">c</span> <span class="id">s</span> <span class="id">n</span>) <span class="kwd">as</span> [<span class="id">E</span>|<span class="id">E</span>]; <span class="id">rewrite</span> <span class="id">E</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.Divergence.html#lessdef_refl">lessdef_refl</a></span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#denot_charact">denot_charact</a></span> (<span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id">b</span> <span class="id">c</span>) <span class="id">s</span>) <span class="kwd">as</span> (<span class="id">i</span> &amp; <span class="id">LIM</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id">LIM</span> <span class="id">i</span>) <span class="kwd">by</span> <span class="id">lia</span>. <span class="id">apply</span> <span class="id">REC</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Équivalence avec la sémantique naturelle.  Dans une direction,
    c'est une simple récurrence sur la dérivation de <span class="bracket"><span class="id">cexec</span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>'</span>
    utilisant les équations de la sémantique dénotationnelle. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cexec_denot">cexec_denot</a></span>: <span class="kwd">forall</span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>', <span class="id"><a href="CDF.IMP.html#cexec">cexec</a></span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>' -&gt; <span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id">c</span> <span class="id">s</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">s</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;<span class="id">induction</span> 1; <span class="id">intros</span>.<br/>
- <span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#denot_skip">denot_skip</a></span>.<br/>
- <span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#denot_assign">denot_assign</a></span>.<br/>
- <span class="id">rewrite</span> <span class="id"><a href="CDF.Divergence.html#denot_seq">denot_seq</a></span>, <span class="id">IHcexec1</span>; <span class="id">auto</span>.<br/>
- <span class="id">rewrite</span> <span class="id"><a href="CDF.Divergence.html#denot_ifthenelse">denot_ifthenelse</a></span>. <span class="id">destruct</span> (<span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span>); <span class="id">auto</span>.<br/>
- <span class="id">rewrite</span> <span class="id"><a href="CDF.Divergence.html#denot_while">denot_while</a></span>, <span class="id">H</span>. <span class="id">auto</span>.<br/>
- <span class="id">rewrite</span> <span class="id"><a href="CDF.Divergence.html#denot_while">denot_while</a></span>, <span class="id">H</span>, <span class="id">IHcexec1</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Dans l'autre direction, il faut d'abord montrer par récurrence sur <span class="bracket"><span class="id">n</span></span>
    que <span class="bracket"><span class="id">cinterp</span> <span class="id">n</span> <span class="id">c</span> <span class="id">s</span> = <span class="id">Some</span> <span class="id">s</span>'</span> implique <span class="bracket"><span class="id">cexec</span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>'</span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cinterp_cexec">cinterp_cexec</a></span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">c</span> <span class="id">s</span> <span class="id">s</span>', <span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">n</span> <span class="id">c</span> <span class="id">s</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">s</span>' -&gt; <span class="id"><a href="CDF.IMP.html#cexec">cexec</a></span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span> <span class="kwd">as</span> [ | <span class="id">n</span>]; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
- <span class="id">discriminate</span>.<br/>
- <span class="id">destruct</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;+ <span class="id">inversion</span> <span class="id">H</span>; <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#cexec_skip">cexec_skip</a></span>.<br/>
&nbsp;&nbsp;+ <span class="id">inversion</span> <span class="id">H</span>; <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#cexec_assign">cexec_assign</a></span>.<br/>
&nbsp;&nbsp;+ <span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">n</span> <span class="id">c1</span> <span class="id">s</span>) <span class="kwd">as</span> [<span class="id">s1</span>|] <span class="id">eqn</span>:<span class="id">C1</span>; <span class="id">try</span> <span class="id">discriminate</span>. <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#cexec_seq">cexec_seq</a></span> <span class="kwd">with</span> <span class="id">s1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#cexec_ifthenelse">cexec_ifthenelse</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="id">destruct</span> (<span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span>) <span class="id">eqn</span>:<span class="id">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#cinterp">cinterp</a></span> <span class="id">n</span> <span class="id">c</span> <span class="id">s</span>) <span class="kwd">as</span> [<span class="id">s1</span>|] <span class="id">eqn</span>:<span class="id">C1</span>; <span class="id">try</span> <span class="id">discriminate</span>. <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#cexec_while_loop">cexec_while_loop</a></span> <span class="kwd">with</span> <span class="id">s1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inversion</span> <span class="id">H</span>; <span class="id">subst</span>; <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#cexec_while_done">cexec_while_done</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Le résultat s'ensuit de la définition de <span class="bracket"><span class="id">denot</span></span> comme limite. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="denot_cexec">denot_cexec</a></span>: <span class="kwd">forall</span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>', <span class="id"><a href="CDF.Divergence.html#denot">denot</a></span> <span class="id">c</span> <span class="id">s</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">s</span>' -&gt; <span class="id"><a href="CDF.IMP.html#cexec">cexec</a></span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#denot_charact">denot_charact</a></span> <span class="id">c</span> <span class="id">s</span>) <span class="kwd">as</span> (<span class="id">i</span> &amp; <span class="id">LIM</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#cinterp_cexec">cinterp_cexec</a></span> <span class="kwd">with</span> <span class="id">i</span>. <span class="id">rewrite</span> <span class="id">LIM</span> <span class="kwd">by</span> <span class="id">lia</span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<h2> 6.3.  Sémantique naturelle coinductive </h2>
<br/>
<div class="doc">Le prédicat <span class="bracket"><span class="id">cexecinf</span> <span class="id">s</span> <span class="id">c</span></span> signifie que la commande <span class="bracket"><span class="id">c</span></span>, lancée dans
    l'état initial <span class="bracket"><span class="id">s</span></span>, diverge.  Il est défini dans le style de la
    sémantique naturelle, mais de manière coinductive. </div>
<br/>
<span class="kwd">CoInductive</span> <span class="id"><a name="cexecinf">cexecinf</a></span>: <span class="id"><a href="CDF.IMP.html#store">store</a></span> -&gt; <span class="id"><a href="CDF.IMP.html#com">com</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="cexecinf_seq_1">cexecinf_seq_1</a></span>: <span class="kwd">forall</span> <span class="id">c1</span> <span class="id">c2</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cexecinf</span> <span class="id">s</span> <span class="id">c1</span> -&gt; <span class="id">cexecinf</span> <span class="id">s</span> (<span class="id"><a href="CDF.IMP.html#SEQ">SEQ</a></span> <span class="id">c1</span> <span class="id">c2</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="cexecinf_seq_2">cexecinf_seq_2</a></span>: <span class="kwd">forall</span> <span class="id">c1</span> <span class="id">c2</span> <span class="id">s</span> <span class="id">s</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.IMP.html#cexec">cexec</a></span> <span class="id">s</span> <span class="id">c1</span> <span class="id">s</span>' -&gt; <span class="id">cexecinf</span> <span class="id">s</span>' <span class="id">c2</span> -&gt; <span class="id">cexecinf</span> <span class="id">s</span> (<span class="id"><a href="CDF.IMP.html#SEQ">SEQ</a></span> <span class="id">c1</span> <span class="id">c2</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="cexecinf_ifthenelse">cexecinf_ifthenelse</a></span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">c1</span> <span class="id">c2</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cexecinf</span> <span class="id">s</span> (<span class="kwd">if</span> <span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span> <span class="kwd">then</span> <span class="id">c1</span> <span class="kwd">else</span> <span class="id">c2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cexecinf</span> <span class="id">s</span> (<span class="id"><a href="CDF.IMP.html#IFTHENELSE">IFTHENELSE</a></span> <span class="id">b</span> <span class="id">c1</span> <span class="id">c2</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="cexecinf_while_1">cexecinf_while_1</a></span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">c</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id">cexecinf</span> <span class="id">s</span> <span class="id">c</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cexecinf</span> <span class="id">s</span> (<span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id">b</span> <span class="id">c</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="cexecinf_while_2">cexecinf_while_2</a></span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">c</span> <span class="id">s</span> <span class="id">s</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="CDF.IMP.html#cexec">cexec</a></span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>' -&gt; <span class="id">cexecinf</span> <span class="id">s</span>' (<span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id">b</span> <span class="id">c</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cexecinf</span> <span class="id">s</span> (<span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id">b</span> <span class="id">c</span>).<br/>
<br/>
<div class="doc">On montre facilement que la boucle <span class="bracket"><span class="id">WHILE</span> <span class="id">TRUE</span> <span class="id">SKIP</span></span> diverge. </div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="cexecinf_while_true_skip">cexecinf_while_true_skip</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="CDF.Divergence.html#cexecinf">cexecinf</a></span> <span class="id">s</span> (<span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id"><a href="CDF.IMP.html#TRUE">TRUE</a></span> <span class="id"><a href="CDF.IMP.html#SKIP">SKIP</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CIH</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="CDF.Divergence.html#cexecinf_while_2">cexecinf_while_2</a></span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#cexec_skip">cexec_skip</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">CIH</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Pour aller plus loin, montrons que si <span class="bracket"><span class="id">cexecinf</span> <span class="id">s</span> <span class="id">c</span></span> est dérivable,
    il existe une suite infinie de réductions à partir de <span class="bracket"><span class="id">c</span>,<span class="id">s</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="red_seq_steps_plus">red_seq_steps_plus</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c2</span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>' <span class="id">c</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Sequences.html#plus">plus</a></span> <span class="id"><a href="CDF.IMP.html#red">red</a></span> (<span class="id">c</span>, <span class="id">s</span>) (<span class="id">c</span>', <span class="id">s</span>') -&gt; <span class="id"><a href="CDF.Sequences.html#plus">plus</a></span> <span class="id"><a href="CDF.IMP.html#red">red</a></span> ((<span class="id">c</span>;;<span class="id">c2</span>), <span class="id">s</span>) ((<span class="id">c</span>';;<span class="id">c2</span>), <span class="id">s</span>').<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">inversion</span> <span class="id">H</span>; <span class="id">subst</span>. <span class="id">destruct</span> <span class="id">b</span> <span class="kwd">as</span> [<span class="id">c1</span> <span class="id">s1</span>]. <br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#red_seq_step">red_seq_step</a></span>; <span class="id">eauto</span>. <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#red_seq_steps">red_seq_steps</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cexecinf_productive">cexecinf_productive</a></span>: <span class="kwd">forall</span> <span class="id">c</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Divergence.html#cexecinf">cexecinf</a></span> <span class="id">s</span> <span class="id">c</span> -&gt; <span class="kwd">exists</span> <span class="id">c</span>' <span class="id">s</span>', <span class="id"><a href="CDF.Sequences.html#plus">plus</a></span> <span class="id"><a href="CDF.IMP.html#red">red</a></span> (<span class="id">c</span>, <span class="id">s</span>) (<span class="id">c</span>', <span class="id">s</span>') /\ <span class="id"><a href="CDF.Divergence.html#cexecinf">cexecinf</a></span> <span class="id">s</span>' <span class="id">c</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">c</span>; <span class="id">intros</span> <span class="id">s</span> <span class="id">EXEC</span>; <span class="id">inversion</span> <span class="id">EXEC</span>; <span class="id">subst</span>.<br/>
- <span class="id">destruct</span> (<span class="id">IHc1</span> <span class="id">_</span> <span class="id">H1</span>) <span class="kwd">as</span> (<span class="id">c</span>' &amp; <span class="id">s</span>' &amp; <span class="id">R</span> &amp; <span class="id">E</span>).<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">c</span>' ;; <span class="id">c2</span>), <span class="id">s</span>'; <span class="id">split</span>. <br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#red_seq_steps_plus">red_seq_steps_plus</a></span>; <span class="id">auto</span>. <br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#cexecinf_seq_1">cexecinf_seq_1</a></span>; <span class="id">auto</span>.<br/>
- <span class="kwd">exists</span> <span class="id">c2</span>, <span class="id">s</span>'; <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="CDF.Sequences.html#plus_right">plus_right</a></span>. <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#red_seq_steps">red_seq_steps</a></span>. <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#cexec_to_reds">cexec_to_reds</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
- <span class="id">do</span> 2 <span class="id">econstructor</span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Sequences.html#plus_one">plus_one</a></span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
- <span class="id">do</span> 2 <span class="id">econstructor</span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Sequences.html#plus_one">plus_one</a></span>. <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#red_while_loop">red_while_loop</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#cexecinf_seq_1">cexecinf_seq_1</a></span>; <span class="id">auto</span>.<br/>
- <span class="id">do</span> 2 <span class="id">econstructor</span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="CDF.Sequences.html#plus_right">plus_right</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="CDF.Sequences.html#star_step">star_step</a></span>. <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#red_while_loop">red_while_loop</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#red_seq_steps">red_seq_steps</a></span>. <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#cexec_to_reds">cexec_to_reds</a></span>; <span class="id">eauto</span>. <br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cexecinf_to_diverges">cexecinf_to_diverges</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">c</span>, <span class="id"><a href="CDF.Divergence.html#cexecinf">cexecinf</a></span> <span class="id">s</span> <span class="id">c</span> -&gt; <span class="id"><a href="CDF.IMP.html#diverges">diverges</a></span> <span class="id">s</span> <span class="id">c</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">set</span> (<span class="id">X</span> := <span class="kwd">fun</span> <span class="id">cs</span> =&gt; <span class="id"><a href="CDF.Divergence.html#cexecinf">cexecinf</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">cs</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">cs</span>)).<br/>
&nbsp;&nbsp;<span class="id">red</span>. <span class="id">apply</span> (<span class="id"><a href="CDF.Sequences.html#infseq_coinduction_principle">infseq_coinduction_principle</a></span> <span class="id">X</span>).<br/>
- <span class="id">intros</span> (<span class="id">c1</span> &amp; <span class="id">s1</span>) <span class="id">D</span>. <br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#cexecinf_productive">cexecinf_productive</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">D</span>) <span class="kwd">as</span> (<span class="id">c2</span> &amp; <span class="id">s2</span> &amp; <span class="id">P</span> &amp; <span class="id">D</span>').<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">c2</span>, <span class="id">s2</span>); <span class="id">auto</span>.<br/>
- <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">L'implication réciproque --- à partir d'une suite infinie de réductions,
    construire une dérivation de <span class="bracket"><span class="id">cexecinf</span> <span class="id">s</span> <span class="id">c</span></span> --- est plus difficile
    à démontrer. </div>
<br/>
<div class="doc">Pour une configuration <span class="bracket">(<span class="id">c</span>, <span class="id">s</span>)</span> donnée, on veut savoir si la réduction
    termine en temps fini sur <span class="bracket">("<span class="id">SKIP</span>", <span class="id">s</span>')</span> ou si une suite infinie
    de réductions est possible.  C'est essentiellement la question du problème
    de l'arrêt.  La démonstration est donc nécessairement non-constructive,
    et utilise l'axiome du tiers exclu. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="red_progress">red_progress</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">s</span>, <span class="id">c</span> = <span class="id"><a href="CDF.IMP.html#SKIP">SKIP</a></span> \/ <span class="kwd">exists</span> <span class="id">c</span>', <span class="kwd">exists</span> <span class="id">s</span>', <span class="id"><a href="CDF.IMP.html#red">red</a></span> (<span class="id">c</span>, <span class="id">s</span>) (<span class="id">c</span>', <span class="id">s</span>').<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">c</span>; <span class="id">intros</span>.<br/>
- <span class="id">auto</span>.<br/>
- <span class="id">right</span>; <span class="id">do</span> 2 <span class="id">econstructor</span>; <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#red_assign">red_assign</a></span>.<br/>
- <span class="id">right</span>. <span class="id">destruct</span> (<span class="id">IHc1</span> <span class="id">s</span>) <span class="kwd">as</span> [<span class="id">E</span> | (<span class="id">c1</span>' &amp; <span class="id">s</span>' &amp; <span class="id">R</span>)].<br/>
&nbsp;&nbsp;+ <span class="id">subst</span> <span class="id">c1</span>. <span class="id">do</span> 2 <span class="id">econstructor</span>; <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#red_seq_done">red_seq_done</a></span>.<br/>
&nbsp;&nbsp;+ <span class="id">do</span> 2 <span class="id">econstructor</span>; <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#red_seq_step">red_seq_step</a></span>; <span class="id">eauto</span>.<br/>
- <span class="id">right</span>. <span class="id">do</span> 2 <span class="id">econstructor</span>; <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#red_ifthenelse">red_ifthenelse</a></span>.<br/>
- <span class="id">right</span>. <span class="id">destruct</span> (<span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span>) <span class="id">eqn</span>:<span class="id">B</span>.<br/>
&nbsp;&nbsp;+ <span class="id">do</span> 2 <span class="id">econstructor</span>; <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#red_while_loop">red_while_loop</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="id">do</span> 2 <span class="id">econstructor</span>; <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#red_while_done">red_while_done</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="terminates_or_diverges">terminates_or_diverges</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">s</span>, <span class="id"><a href="CDF.IMP.html#diverges">diverges</a></span> <span class="id">s</span> <span class="id">c</span> \/ <span class="kwd">exists</span> <span class="id">s</span>', <span class="id"><a href="CDF.IMP.html#terminates">terminates</a></span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span> (<span class="id"><a href="CDF.Sequences.html#all_seq_inf">all_seq_inf</a></span> <span class="id"><a href="CDF.IMP.html#red">red</a></span> (<span class="id">c</span>, <span class="id">s</span>))).<br/>
- <span class="id">left</span>. <span class="id">apply</span> <span class="id"><a href="CDF.Sequences.html#infseq_if_all_seq_inf">infseq_if_all_seq_inf</a></span>; <span class="id">auto</span>.<br/>
- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> ((<span class="id">c</span>' &amp; <span class="id">s</span>') &amp; <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#imply_to_and">imply_to_and</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">STAR</span> <span class="id">H</span>].<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#red_progress">red_progress</a></span> <span class="id">c</span>' <span class="id">s</span>') <span class="kwd">as</span> [<span class="id">E</span> | (<span class="id">c</span>'' &amp; <span class="id">s</span>'' &amp; <span class="id">RED</span>)].<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">c</span>'. <span class="id">right</span>; <span class="kwd">exists</span> <span class="id">s</span>'; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">elim</span> <span class="id">H</span>; <span class="kwd">exists</span> (<span class="id">c</span>'', <span class="id">s</span>''); <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">On peut alors montrer des lemmes d'inversion qui analysent la
    structure des suites infinies de réductions pour une séquence
    <span class="bracket"><span class="id">c1</span>;;<span class="id">c2</span></span>, une boucle, etc. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="diverges_steps_inv">diverges_steps_inv</a></span>: <span class="kwd">forall</span> <span class="id">c</span> <span class="id">s</span> <span class="id">c</span>' <span class="id">s</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.IMP.html#diverges">diverges</a></span> <span class="id">s</span> <span class="id">c</span> -&gt; <span class="id"><a href="CDF.Sequences.html#star">star</a></span> <span class="id"><a href="CDF.IMP.html#red">red</a></span> (<span class="id">c</span>, <span class="id">s</span>) (<span class="id">c</span>', <span class="id">s</span>') -&gt; <span class="id"><a href="CDF.IMP.html#diverges">diverges</a></span> <span class="id">s</span>' <span class="id">c</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="CDF.Sequences.html#infseq_star_inv">infseq_star_inv</a></span> <span class="kwd">with</span> (<span class="id">c</span>, <span class="id">s</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="CDF.IMP.html#red_determ">red_determ</a></span>; <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="terminates_not_diverges">terminates_not_diverges</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>', <span class="id"><a href="CDF.IMP.html#terminates">terminates</a></span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>' -&gt; <span class="id"><a href="CDF.IMP.html#diverges">diverges</a></span> <span class="id">s</span> <span class="id">c</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;<span class="id">intros</span>. <br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">D</span>: <span class="id"><a href="CDF.IMP.html#diverges">diverges</a></span> <span class="id">s</span>' <span class="id"><a href="CDF.IMP.html#SKIP">SKIP</a></span>).<br/>
&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="CDF.Divergence.html#diverges_steps_inv">diverges_steps_inv</a></span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Sequences.html#infseq_inv">infseq_inv</a></span> <span class="kwd">in</span> <span class="id">D</span>. <span class="id">destruct</span> <span class="id">D</span> <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">R</span> &amp; <span class="id">I</span>). <span class="id">inversion</span> <span class="id">R</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="diverges_seq_inv">diverges_seq_inv</a></span>: <span class="kwd">forall</span> <span class="id">s</span> <span class="id">c1</span> <span class="id">c2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.IMP.html#diverges">diverges</a></span> <span class="id">s</span> (<span class="id">c1</span> ;; <span class="id">c2</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.IMP.html#diverges">diverges</a></span> <span class="id">s</span> <span class="id">c1</span> \/ <span class="kwd">exists</span> <span class="id">s</span>', <span class="id"><a href="CDF.IMP.html#terminates">terminates</a></span> <span class="id">s</span> <span class="id">c1</span> <span class="id">s</span>' /\ <span class="id"><a href="CDF.IMP.html#diverges">diverges</a></span> <span class="id">s</span>' <span class="id">c2</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#terminates_or_diverges">terminates_or_diverges</a></span> <span class="id">c1</span> <span class="id">s</span>) <span class="kwd">as</span> [<span class="id">D</span> | (<span class="id">s</span>' &amp; <span class="id">T</span>)].<br/>
- <span class="id">auto</span>.<br/>
- <span class="id">right</span>; <span class="kwd">exists</span> <span class="id">s</span>'; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="CDF.Divergence.html#diverges_steps_inv">diverges_steps_inv</a></span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="CDF.Sequences.html#star_trans">star_trans</a></span>. <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#red_seq_steps">red_seq_steps</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Sequences.html#star_one">star_one</a></span>; <span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="diverges_loop_inv">diverges_loop_inv</a></span>: <span class="kwd">forall</span> <span class="id">s</span> <span class="id">b</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.IMP.html#diverges">diverges</a></span> <span class="id">s</span> (<span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id">b</span> <span class="id">c</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> /\<br/>
&nbsp;&nbsp;(<span class="id"><a href="CDF.IMP.html#diverges">diverges</a></span> <span class="id">s</span> <span class="id">c</span> \/ <span class="kwd">exists</span> <span class="id">s</span>', <span class="id"><a href="CDF.IMP.html#terminates">terminates</a></span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>' /\ <span class="id"><a href="CDF.IMP.html#diverges">diverges</a></span> <span class="id">s</span>' (<span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id">b</span> <span class="id">c</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="CDF.Sequences.html#infseq_inv">infseq_inv</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> ((<span class="id">c1</span> &amp; <span class="id">s1</span>) &amp; <span class="id">R1</span> &amp; <span class="id">INF1</span>).<br/>
&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">R1</span>; <span class="id">subst</span>.<br/>
- <span class="id">elim</span> (<span class="id"><a href="CDF.Divergence.html#terminates_not_diverges">terminates_not_diverges</a></span> <span class="id">s1</span> <span class="id"><a href="CDF.IMP.html#SKIP">SKIP</a></span> <span class="id">s1</span>); <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="CDF.Sequences.html#star_refl">star_refl</a></span>.<br/>
- <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#terminates_or_diverges">terminates_or_diverges</a></span> <span class="id">c</span> <span class="id">s1</span>) <span class="kwd">as</span> [<span class="id">D</span> | (<span class="id">s2</span> &amp; <span class="id">T</span>)].<br/>
+ <span class="id">auto</span>.<br/>
+ <span class="id">right</span>; <span class="kwd">exists</span> <span class="id">s2</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="CDF.Divergence.html#diverges_steps_inv">diverges_steps_inv</a></span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="CDF.Sequences.html#star_trans">star_trans</a></span>. <span class="id">apply</span> <span class="id"><a href="CDF.IMP.html#red_seq_steps">red_seq_steps</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Sequences.html#star_one">star_one</a></span>; <span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<div class="doc">On montre enfin l'implication attendue, par coinduction. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="diverges_to_cexecinf">diverges_to_cexecinf</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">c</span>, <span class="id"><a href="CDF.IMP.html#diverges">diverges</a></span> <span class="id">s</span> <span class="id">c</span> -&gt; <span class="id"><a href="CDF.Divergence.html#cexecinf">cexecinf</a></span> <span class="id">s</span> <span class="id">c</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CIH</span>; <span class="id">intros</span> <span class="id">s</span> <span class="id">c</span> <span class="id">D</span>. <span class="id">destruct</span> <span class="id">c</span>.<br/>
- <span class="comment">(*&nbsp;SKIP&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">eelim</span> <span class="id"><a href="CDF.Divergence.html#terminates_not_diverges">terminates_not_diverges</a></span>; <span class="id">eauto</span>.  <span class="id">apply</span> <span class="id"><a href="CDF.Sequences.html#star_refl">star_refl</a></span>.<br/>
- <span class="comment">(*&nbsp;ASSIGN&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">eelim</span> <span class="id"><a href="CDF.Divergence.html#terminates_not_diverges">terminates_not_diverges</a></span>; <span class="id">eauto</span>.  <span class="id">apply</span> <span class="id"><a href="CDF.Sequences.html#star_one">star_one</a></span>. <span class="id">constructor</span>.<br/>
- <span class="comment">(*&nbsp;SEQ&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#diverges_seq_inv">diverges_seq_inv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">D</span>) <span class="kwd">as</span> [<span class="id">D1</span> | (<span class="id">s</span>' &amp; <span class="id">T1</span> &amp; <span class="id">D2</span>)].<br/>
&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#cexecinf_seq_1">cexecinf_seq_1</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#cexecinf_seq_2">cexecinf_seq_2</a></span> <span class="kwd">with</span> <span class="id">s</span>'; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.IMP.html#reds_to_cexec">reds_to_cexec</a></span>.<br/>
- <span class="comment">(*&nbsp;IFTHENELSE&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Sequences.html#infseq_inv">infseq_inv</a></span> <span class="kwd">in</span> <span class="id">D</span>. <span class="id">destruct</span> <span class="id">D</span> <span class="kwd">as</span> ((<span class="id">c</span>' &amp; <span class="id">s</span>') &amp; <span class="id">R</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">R</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#cexecinf_ifthenelse">cexecinf_ifthenelse</a></span>; <span class="id">auto</span>.<br/>
- <span class="comment">(*&nbsp;WHILE&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="CDF.Divergence.html#diverges_loop_inv">diverges_loop_inv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">D</span>) <span class="kwd">as</span> (<span class="id">B</span> &amp; [<span class="id">D1</span> | (<span class="id">s</span>' &amp; <span class="id">T1</span> &amp; <span class="id">D2</span>)]).<br/>
&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#cexecinf_while_1">cexecinf_while_1</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="CDF.Divergence.html#cexecinf_while_2">cexecinf_while_2</a></span> <span class="kwd">with</span> <span class="id">s</span>'; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="CDF.IMP.html#reds_to_cexec">reds_to_cexec</a></span>.<br/>
Qed.</div>
<br/>
<h2> 6.4.  Application à la vérification de compilateurs </h2>
<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">Z_scope</span>.<br/>
<br/>
<div class="doc">Dans le deuxième cours, nous avions utilisé la sémantique naturelle
    pour montrer que les programmes qui terminent sont correctement compilés. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="compile_com_correct_terminating">compile_com_correct_terminating</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.IMP.html#cexec">cexec</a></span> <span class="id">s</span> <span class="id">c</span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">C</span> <span class="id">pc</span> σ,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Compil.html#code_at">code_at</a></span> <span class="id">C</span> <span class="id">pc</span> (<span class="id"><a href="CDF.Compil.html#compile_com">compile_com</a></span> <span class="id">c</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Compil.html#transitions">transitions</a></span> <span class="id">C</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">pc</span>, σ, <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">pc</span> + <span class="id"><a href="CDF.Compil.html#codelen">codelen</a></span> (<span class="id"><a href="CDF.Compil.html#compile_com">compile_com</a></span> <span class="id">c</span>), σ, <span class="id">s</span>').<br/>
<span class="kwd">Proof</span> <span class="id"><a href="CDF.Compil.html#compile_com_correct_terminating">Compil.compile_com_correct_terminating</a></span>.<br/>
<br/>
<div class="doc">C'était une jolie démonstration, mais elle ne disait rien sur la compilation
    des programmes IMP qui ne terminent pas.  Cela nous avait conduit à mettre
    en place une autre démonstration, plus complexe, à base de sémantique
    à transitions et de diagrammes de simulation. </div>
<br/>
<div class="doc">Maintenant que nous disposons d'une sémantique naturelle pour les programmes
    qui divergent, nous pouvons l'utiliser pour démontrer assez simplement aussi
    que les programmes qui divergent sont compilés en un code machine qui
    ne termine pas. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="compile_com_productive">compile_com_productive</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Divergence.html#cexecinf">cexecinf</a></span> <span class="id">s</span> <span class="id">c</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">C</span> <span class="id">pc</span> σ,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Compil.html#code_at">code_at</a></span> <span class="id">C</span> <span class="id">pc</span> (<span class="id"><a href="CDF.Compil.html#compile_com">compile_com</a></span> <span class="id">c</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">c</span>' <span class="id">pc</span>' <span class="id">s</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CDF.Sequences.html#plus">plus</a></span> (<span class="id"><a href="CDF.Compil.html#transition">transition</a></span> <span class="id">C</span>) (<span class="id">pc</span>, σ, <span class="id">s</span>) (<span class="id">pc</span>', σ, <span class="id">s</span>')<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="CDF.Divergence.html#cexecinf">cexecinf</a></span> <span class="id">s</span>' <span class="id">c</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="CDF.Compil.html#code_at">code_at</a></span> <span class="id">C</span> <span class="id">pc</span>' (<span class="id"><a href="CDF.Compil.html#compile_com">compile_com</a></span> <span class="id">c</span>').<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">c</span>; <span class="id">intros</span> <span class="id">s</span> <span class="id">EXEC</span> <span class="id">C</span> <span class="id">pc</span> σ <span class="id">CODEAT</span>;<br/>
&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">EXEC</span>; <span class="id">subst</span>; <span class="id">clear</span> <span class="id">EXEC</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">CODEAT</span>.<br/>
- <span class="comment">(*&nbsp;SEQ,&nbsp;gauche&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHc1</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">code</span>.<br/>
- <span class="comment">(*&nbsp;SEQ,&nbsp;droite&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">IHc2</span> <span class="kwd">as</span> (<span class="id">c</span>' &amp; <span class="id">pc</span>' &amp; <span class="id">s</span>'' &amp; <span class="id">PLUS</span> &amp; <span class="id">EXEC</span>' &amp; <span class="id">CODEAT</span>'); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">code</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">c</span>', <span class="id">pc</span>', <span class="id">s</span>''; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="CDF.Sequences.html#star_plus_trans">star_plus_trans</a></span>. <span class="id">eapply</span> <span class="id"><a href="CDF.Divergence.html#compile_com_correct_terminating">compile_com_correct_terminating</a></span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">code</span>. <span class="id">exact</span> <span class="id">PLUS</span>.<br/>
- <span class="comment">(*&nbsp;IFTHENELSE&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">code1</span> := <span class="id"><a href="CDF.Compil.html#compile_com">compile_com</a></span> <span class="id">c1</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">code2</span> := <span class="id"><a href="CDF.Compil.html#compile_com">compile_com</a></span> <span class="id">c2</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">codeb</span> := <span class="id"><a href="CDF.Compil.html#compile_bexp">compile_bexp</a></span> <span class="id">b</span> 0 (<span class="id"><a href="CDF.Compil.html#codelen">codelen</a></span> <span class="id">code1</span> + 1)) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="CDF.IMP.html#beval">beval</a></span> <span class="id">b</span> <span class="id">s</span>) <span class="id">eqn</span>:<span class="id">B</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;La&nbsp;branche&nbsp;"then"&nbsp;est&nbsp;exécutée&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">IHc1</span> <span class="kwd">as</span> (<span class="id">c</span>' &amp; <span class="id">pc</span>' &amp; <span class="id">s</span>' &amp; <span class="id">PLUS</span> &amp; <span class="id">EXEC</span>' &amp; <span class="id">CODEAT</span>'); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">code</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">c</span>', <span class="id">pc</span>', <span class="id">s</span>'; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="CDF.Sequences.html#star_plus_trans">star_plus_trans</a></span>. <span class="id">eapply</span> <span class="id"><a href="CDF.Compil.html#compile_bexp_correct">compile_bexp_correct</a></span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">b</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">code</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> <span class="id">codeb</span>. <span class="id">rewrite</span> <span class="id">B</span>. <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">code</span>. <span class="id">eexact</span> <span class="id">PLUS</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;La&nbsp;branche&nbsp;"else"&nbsp;est&nbsp;exécutée&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">IHc2</span> <span class="kwd">as</span> (<span class="id">c</span>' &amp; <span class="id">pc</span>' &amp; <span class="id">s</span>' &amp; <span class="id">PLUS</span> &amp; <span class="id">EXEC</span>' &amp; <span class="id">CODEAT</span>'); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">code</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">c</span>', <span class="id">pc</span>', <span class="id">s</span>'; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="CDF.Sequences.html#star_plus_trans">star_plus_trans</a></span>. <span class="id">eapply</span> <span class="id"><a href="CDF.Compil.html#compile_bexp_correct">compile_bexp_correct</a></span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">b</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">code</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> <span class="id">codeb</span>. <span class="id">rewrite</span> <span class="id">B</span>. <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">code</span>. <span class="id">eexact</span> <span class="id">PLUS</span>.<br/>
- <span class="comment">(*&nbsp;WHILE,&nbsp;première&nbsp;itération&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">IHc</span> <span class="kwd">as</span> (<span class="id">c</span>' &amp; <span class="id">pc</span>' &amp; <span class="id">s</span>' &amp; <span class="id">PLUS</span> &amp; <span class="id">EXEC</span>' &amp; <span class="id">CODEAT</span>'); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">code</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">c</span>', <span class="id">pc</span>', <span class="id">s</span>'; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="CDF.Sequences.html#star_plus_trans">star_plus_trans</a></span>. <span class="id">eapply</span> <span class="id"><a href="CDF.Compil.html#compile_bexp_correct">compile_bexp_correct</a></span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">b</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">code</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H2</span>. <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">code</span>. <span class="id">eexact</span> <span class="id">PLUS</span>.<br/>
- <span class="comment">(*&nbsp;WHILE,&nbsp;itérations&nbsp;suivantes&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="CDF.IMP.html#WHILE">WHILE</a></span> <span class="id">b</span> <span class="id">c</span>), <span class="id">pc</span>, <span class="id">s</span>'; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="CDF.Sequences.html#star_plus_trans">star_plus_trans</a></span>. <span class="id">eapply</span> <span class="id"><a href="CDF.Compil.html#compile_bexp_correct">compile_bexp_correct</a></span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">b</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">code</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H1</span>. <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">code</span>. <br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="CDF.Sequences.html#star_plus_trans">star_plus_trans</a></span>. <span class="id">eapply</span> <span class="id"><a href="CDF.Divergence.html#compile_com_correct_terminating">compile_com_correct_terminating</a></span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">code</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Sequences.html#plus_one">plus_one</a></span>. <span class="id">eapply</span> <span class="id"><a href="CDF.Compil.html#trans_branch">trans_branch</a></span>. <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">code</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="compile_com_correct_diverging">compile_com_correct_diverging</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Divergence.html#cexecinf">cexecinf</a></span> <span class="id">s</span> <span class="id">c</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">C</span> <span class="id">pc</span> σ,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Compil.html#code_at">code_at</a></span> <span class="id">C</span> <span class="id">pc</span> (<span class="id"><a href="CDF.Compil.html#compile_com">compile_com</a></span> <span class="id">c</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Sequences.html#infseq">infseq</a></span> (<span class="id"><a href="CDF.Compil.html#transition">transition</a></span> <span class="id">C</span>) (<span class="id">pc</span>, σ, <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;<span class="id">intros</span>. <br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">X</span> := <span class="kwd">fun</span> (<span class="id">pcss</span>: <span class="id"><a href="CDF.Compil.html#config">config</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">pc</span>, σ, <span class="id">s</span>) := <span class="id">pcss</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">c</span>, <span class="id"><a href="CDF.Divergence.html#cexecinf">cexecinf</a></span> <span class="id">s</span> <span class="id">c</span> /\ <span class="id"><a href="CDF.Compil.html#code_at">code_at</a></span> <span class="id">C</span> <span class="id">pc</span> (<span class="id"><a href="CDF.Compil.html#compile_com">compile_com</a></span> <span class="id">c</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="CDF.Sequences.html#infseq_coinduction_principle">infseq_coinduction_principle</a></span> <span class="kwd">with</span> <span class="id">X</span>.<br/>
- <span class="id">intros</span> [[<span class="id">pc1</span> σ1] <span class="id">s1</span>] (<span class="id">c1</span> &amp; <span class="id">EXEC</span> &amp; <span class="id">CODEAT</span>).<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="CDF.Divergence.html#compile_com_productive">compile_com_productive</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">EXEC</span>) <span class="kwd">as</span> (<span class="id">c</span>' &amp; <span class="id">pc</span>' &amp; <span class="id">s</span>' &amp; <span class="id">PLUS</span> &amp; <span class="id">EXEC</span>' &amp; <span class="id">CODEAT</span>'); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">pc</span>', σ1, <span class="id">s</span>'); <span class="id">split</span>. <span class="id">exact</span> <span class="id">PLUS</span>. <span class="kwd">exists</span> <span class="id">c</span>'; <span class="id">auto</span>.<br/>
- <span class="kwd">exists</span> <span class="id">c</span>; <span class="id">auto</span>.<br/>
Qed.</div>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
